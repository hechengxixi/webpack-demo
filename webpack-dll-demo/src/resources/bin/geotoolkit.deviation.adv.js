/* tslint:disable */
/* eslint-disable */
/**
 * Copyright: Copyright (c) 2016 by INT, Inc.  All rights reserved.<br>
 * Company: INT, Inc. <br>
 * INT PROPRIETARY/CONFIDENTIAL. Use is subject to license terms.
 */
(function (root, factory) {
if (root && typeof root['define'] === 'function') {
    root['define']("geotoolkit.deviation", ["geotoolkit.controls","geotoolkit.svg"], function() {
      root._geo = factory(root, root._geo);
      root.geotoolkit = root._geo.geotoolkit || root.geotoolkit;
      return root.geotoolkit;
    });
} else if (typeof module !== 'undefined' && typeof module.exports === 'object') {
    var m = factory(root, root && root._geo);
    module.exports._geo = m;
    if (root) { 
        root._geo = module.exports._geo;
        if(!root.geotoolkit) {
            root.geotoolkit = module.exports._geo.geotoolkit;
        }
    }
    if (!module.exports.geotoolkit) module.exports.geotoolkit=module.exports._geo.geotoolkit;
} else {
    root._geo = factory(root, root._geo);
    root.geotoolkit = root._geo.geotoolkit || root.geotoolkit;
    return root.geotoolkit;
}

}(typeof window !== "undefined" ? window : undefined, function (window, _geo) {
var _geo=_geo||{};_geo.geotoolkit.kd=_geo.geotoolkit.kd||{};_geo.geotoolkit.kd.ia=_geo.geotoolkit.kd.ia||{};_geo.geotoolkit.kd.Bk={wd:"Left",lb:"Center",$c:"Right"};
_geo.geotoolkit.kd.Bb=function(){function b(a){return 0<=a?Math.floor(a+.5):Math.ceil(a-.5)}function a(){}_geo.geotoolkit.da(a,"geotoolkit.deviation.Util");a.IS=function(a){return 0>a?Math.ceil(a):Math.floor(a)};a.aHa=function(a,b){return a.getX()*b.getX()+a.getY()*b.getY()};a.Qrd=function(a,b){return a.getX()*b.getY()-a.getY()*b.getX()};a.E9c=function(a,b,e){var c=(a.getX()-b.getX())*(e.getX()-b.getX())+(a.getY()-b.getY())*(e.getY()-b.getY());a=(a.getX()-b.getX())*(e.getY()-b.getY())-(a.getY()-b.getY())*
(e.getX()-b.getX());return 0!==c||0!==a?Math.atan2(a,c):0};a.zw=function(a,d,e,c){if(c){if(c=b(d.getX()),d=b(d.getY()),0<Math.abs(e.getX()-c)||0<Math.abs(e.getY()-d))e.bb(c,d),a.push(new _geo.geotoolkit.util.na(c,d))}else a.push(d)};a.Sgd=function(a,b,e,c,f){var k=0<=(a.getY()-b.getY())*(e.getX()-b.getX())-(a.getX()-b.getX())*(e.getY()-b.getY());return k!==0<=(a.getY()-e.getY())*(c.getX()-e.getX())-(a.getX()-e.getX())*(c.getY()-e.getY())||k!==0<=(a.getY()-c.getY())*(f.getX()-c.getX())-(a.getX()-c.getX())*
(f.getY()-c.getY())||k!==0<=(a.getY()-f.getY())*(b.getX()-f.getX())-(a.getX()-f.getX())*(b.getY()-f.getY())?!1:!0};a.vQb=function(a,b,e,c,f){var k=(c.getY()-e.getY())*(b.getX()-a.getX())-(c.getX()-e.getX())*(b.getY()-a.getY());return 0!==k?(c=((c.getX()-e.getX())*(a.getY()-e.getY())-(c.getY()-e.getY())*(a.getX()-e.getX()))/k,e=a.getY()+c*(b.getY()-a.getY()),a=a.getX()+c*(b.getX()-a.getX()),f.bb(a,e),!0):!1};a.vGc=function(a,b,e,c){var f=0<=(a.getY()-b.getY())*(e.getX()-b.getX())-(a.getX()-b.getX())*
(e.getY()-b.getY());return f!==0<=(a.getY()-e.getY())*(c.getX()-e.getX())-(a.getX()-e.getX())*(c.getY()-e.getY())||f!==0<=(a.getY()-c.getY())*(b.getX()-c.getX())-(a.getX()-c.getX())*(b.getY()-c.getY())?!1:!0};a.getLength=function(a){return Math.abs(a.getX())<=Number.MIN_VALUE?Math.abs(a.getY()):Math.abs(a.getY())<=Number.MIN_VALUE?Math.abs(a.getX()):Math.sqrt(a.getX()*a.getX()+a.getY()*a.getY())};a.aKc=function(a){var b=a?a.length:0;return 2>b?!0:_geo.geotoolkit.util.na.Cj(a[0],a[b-1])<_geo.geotoolkit.util.Math.Jc};
a.WP=function(a,b,e){a=a.getY()===b.getY()?(a.getX()+b.getX())/2:a.getX()+(b.getX()-a.getX())*(e-a.getY())/(b.getY()-a.getY());return new _geo.geotoolkit.util.na(a,e)};a.uGc=function(a,b,e){var c=_geo.geotoolkit.util.Math.Jc,f=b.getY()-a.getY();if(0===f)return Math.abs(a.getY()-e.getY())<=c;var k=b.getX()-a.getX();return 0===k?Math.abs(a.getX()-e.getX())<=c:Math.abs(a.getX()+(b.getX()-a.getX())*(e.getY()-a.getY())/f-e.getX())<=c||Math.abs(a.getY()+(b.getY()-a.getY())*(e.getX()-a.getX())/k-e.getY())<=
c?!0:!1};a.Huc=function(a,b,e,c,f,k,h){if(0>=h)throw Error("Invalid radius");var l=Math.atan2(b-c,a-e);f=Math.atan2(k-c,f-e);var n=f-l;k=-Math.sign(n);if(Math.abs(n)<=Number.MIN_VALUE)throw Error("Invalid angles");var p=Math.abs(n/2),r=h/Math.sin(p),n=r*Math.cos((l+f)/2),t=r*Math.sin((l+f)/2),q=r*Math.cos(p),p=q*Math.cos(l),r=q*Math.sin(l),m=q*Math.cos(f),q=q*Math.sin(f);return{line:{Yrd:a,Zrd:b,HTc:k*p+e,KTc:k*r+c},arc:{left:k*n+e-h,top:k*t+c-h,hn:l+Math.PI/2,dI:f-Math.PI/2},jq:{x:k*m+e,y:k*q+c}}};
a.Gdd=function(b,d,e,c){var f=c||a.wfd(b,d);if(0===f.length)return[];if(1===f.length)return a.nDc(b,d,e);c=[];var k,h,l;for(l=0;l<f.length;++l)for(k=b.slice(f[l].from,f[l].fh+1),h=d.slice(f[l].from,f[l].fh+1),k=a.nDc(k,h,e),h=0;h<k.length;++h)c.push(k[h].from),c.push(k[h].fh);c.sort(function(a,b){return a-b});b=[];for(l=0;l<c.length;l+=2)b.push({from:c[l],fh:c[l+1]});return b};a.wfd=function(a,b){for(var e=Math.min(a.length,b.length),c=[],f,k,h,l,n=0;n<e;++n){f=a[n];k=b[n];for(var p=n+2;p<e;++p)if(h=
a[p],l=b[p],f===h&&k===l){c.push({from:n,fh:p});n=p;break}}0===c.length&&c.push({from:0,fh:c.length-1});return c};a.nDc=function(a,b,e){var c=[],f=Math.min(a.length,b.length),k=[],h,l,n,p,r;for(h=1;h<f;++h)b[h]===b[h-1]||b[h]<e&&b[h-1]<e||b[h]>e&&b[h-1]>e||(b[h-1]>b[h]?(n=b[h],r=b[h-1],l=a[h],p=a[h-1]):(n=b[h-1],r=b[h],l=a[h-1],p=a[h]),n!==e&&(l=l===p?p:l+(e-n)*(p-l)/(r-n),k.push(l)));if(2>k.length)return c;k.sort(function(a,b){return a-b});for(h=0;h<k.length;h+=2)c.push({from:k[h],fh:k[h+1]});return c};
a.sKc=function(a,b){return Math.abs(a-b)<=1E-12*Math.min(Math.abs(a),Math.abs(b))};return a}();
_geo.geotoolkit.kd.Line=function(){function b(a,b){this.Tza=window.NaN;this.CY=new _geo.geotoolkit.util.na;this.Dw(a,b)}var a=new _geo.geotoolkit.util.na;_geo.geotoolkit.da(b,"geotoolkit.deviation.Line");b.prototype.Dw=function(b,d){if("number"===typeof d)this.CY.bb(b.getX(),b.getY()),this.Tza=d;else if(d instanceof _geo.geotoolkit.util.na){a.bb(d.getY()-b.getY(),b.getX()-d.getX());var e=_geo.geotoolkit.kd.Bb.aHa(a,a),c;e>_geo.geotoolkit.util.Math.Jc?(c=Math.sqrt(e),e=a.getX()/c,c=a.getY()/c):(e=
1,c=0);this.CY.bb(e,c);this.Tza=-_geo.geotoolkit.kd.Bb.aHa(this.CY,b)}else this.Tza=b.Tza,this.CY.bb(b.CY.getX(),b.CY.getY())};b.prototype.bvb=function(){return this.CY};b.prototype.dAd=function(a){this.CY=a};b.prototype.DPa=function(){return this.Tza};b.prototype.bAd=function(a){this.Tza=a};b.prototype.distance=function(a){return _geo.geotoolkit.kd.Bb.aHa(this.CY,a)+this.Tza};b.prototype.project=function(a){var b=this.distance(a);return new _geo.geotoolkit.util.na(a.getX()-this.CY.getX()*b,a.getY()-
this.CY.getY()*b)};b.prototype.zyd=function(a){var b=2*this.distance(a);return new _geo.geotoolkit.util.na(a.getX()-this.CY.getX()*b,a.getY()-this.CY.getY()*b)};b.s8c=function(a,b){var e=a.bvb(),c=b.bvb();return Math.abs(e.getX()*c.getY()-c.getX()*e.getY())<_geo.geotoolkit.util.Math.Jc};b.TKc=function(a,b){var e=a.bvb(),c=b.bvb(),f=e.getX()*c.getY()-c.getX()*e.getY(),k=a.DPa(),h=b.DPa(),l=e.getY()*h-c.getY()*k,e=c.getX()*k-e.getX()*h;return new _geo.geotoolkit.util.na(l/f,e/f)};return b}();
_geo.geotoolkit.kd.bZc=function(){function b(){this.cg;this.Nlb=[]}_geo.geotoolkit.da(b,"geotoolkit.deviation.MappedPixel");b.prototype.clear=function(){this.Nlb=[]};b.prototype.append=function(a){this.Nlb.push(a)};b.prototype.get=function(a){return this.Nlb[a]};b.prototype.getSize=function(){return this.Nlb.length};return b}();
_geo.geotoolkit.kd.Zfb=function(){function b(){this.PAa=[]}function a(a){var b=a.getSize(),c=a.Wf();a=a.Jg();var d=0===b||c[0]===c[b-1]&&a[0]===a[b-1];if(b<(d?4:3))return 0;for(var e=0,g=1;g<b;++g)e+=c[g-1]*a[g]-a[g-1]*c[g];d||(e+=c[b-1]*a[0]-a[b-1]*c[0]);return Math.abs(e/2)}function g(a,b,c){this.Gh=a;this.Ah=b;this.area=c}var d=_geo.geotoolkit.kd.Bb,e=8;_geo.geotoolkit.da(b,"geotoolkit.deviation.PixelMapper");b.prototype.je=_geo.geotoolkit.Ia;var c=new _geo.geotoolkit.util.na,f=new _geo.geotoolkit.util.na,
k=new _geo.geotoolkit.util.na,h=new _geo.geotoolkit.util.na,l=new _geo.geotoolkit.util.Fc,n=new _geo.geotoolkit.util.Fc,p=new _geo.geotoolkit.util.Rect;b.prototype.Ard=function(b,e,q){var m=b.getX();b=b.getY();m=[this.je(c.bb(m,b)),this.je(f.bb(m+1,b)),this.je(k.bb(m+1,b+1)),this.je(h.bb(m,b+1))];m.forEach(function(a){a.y*=q});b=0>m[0].x?1-d.IS(m[0].x):-d.IS(m[0].x);for(var u=0>m[0].y?1-d.IS(m[0].y):-d.IS(m[0].y),v=window.Infinity,w=-window.Infinity,x=window.Infinity,A=-window.Infinity,z=0;z<m.length;z++)m[z].x+=
b,m[z].y+=u,v=Math.min(v,m[z].x),w=Math.max(w,m[z].x),x=Math.min(x,m[z].y),A=Math.max(A,m[z].y);b=new _geo.geotoolkit.kd.bZc;if(_geo.geotoolkit.util.Rect.mB.$C(p.zb(v,x,w,A)))m=A-x,u=w-v,A=0+m*v+-u*A,A+=-m*w,A+=u*x,b.append(new g(0,0,A));else for(u=d.IS(m[0].x),z=d.IS(m[0].y),v=Math.floor(v),w=Math.ceil(w),x=Math.floor(x),A=Math.ceil(A);v<w;++v)for(var C=x;C<A;++C){var D=new _geo.geotoolkit.util.$f;D.union(l.Ne([m[0].x,m[1].x,m[2].x,m[3].x],[m[0].y,m[1].y,m[2].y,m[3].y]),D);D=D.intersect(n.Ne([v,
v+1,v+1,v],[C,C,C+1,C+1]));0<D.length&&b.append(new g(v-u,C-z,a(D[0])))}this.PAa[e]=b};b.prototype.lZb=function(a,b){var c=this.je(a),g=c.getX()-(0>c.getX()?d.IS(c.getX())-1:d.IS(c.getX())),f=c.getY()-(0>c.getY()?d.IS(c.getY())-1:d.IS(c.getY())),g=d.IS(g*e)+d.IS(f*e)*e;this.PAa[g]&&0!==this.PAa[g].getSize()||this.Ard(a,g,b);this.PAa[g].cg=c;return this.PAa[g]};b.prototype.zPb=function(){for(var a=0;a<this.PAa.length;++a)this.PAa[a].clear()};return b}();
_geo.geotoolkit.kd.q1c=function(){function b(){_geo.geotoolkit.kd.Zfb.call(this);this.UL=null;this.dd=new _geo.geotoolkit.util.Ga;this.r=new _geo.geotoolkit.util.Rect;this.Zmb=new _geo.geotoolkit.util.na}_geo.geotoolkit.fa(b,_geo.geotoolkit.kd.Zfb);_geo.geotoolkit.da(b,"geotoolkit.deviation.TVDTrajectoryStation");b.prototype.Lm=function(){return this.r};b.prototype.di=function(){return this.dd.cb(this.Zmb.bb(this.r.sa(),this.r.qa()))};b.prototype.zr=function(){return this.dd.cb(this.Zmb.bb(this.r.sa(),
this.r.wa()))};b.prototype.st=function(){return this.dd.cb(this.Zmb.bb(this.r.za(),this.r.qa()))};b.prototype.Sn=function(){return this.dd.cb(this.Zmb.bb(this.r.za(),this.r.wa()))};b.prototype.iN=function(){return this.UL=this.UL||this.dd.Vd()};b.prototype.Ra=function(){return this.dd};b.prototype.kc=function(a){this.dd=a;this.UL=null;this.zPb();return this};b.prototype.offset=function(a,b){this.dd.GD(this.dd.ti()+a,this.dd.Th()+b);this.UL=null;return this};b.prototype.Oqd=function(){var a=this.r.sa(),
b=this.r.za(),d=this.r.qa(),e=this.r.wa(),c=this.dd.dg(a,e),f=c.getX(),c=c.getY(),k=this.dd.dg(b,d),h=k.getX(),k=k.getY(),a=this.dd.dg(a,d),d=a.getX(),a=a.getY(),b=this.dd.dg(b,e),l=b.getX(),e=b.getY(),b=Math.min(Math.min(f,h),Math.min(d,l)),f=Math.max(Math.max(f,h),Math.max(d,l)),h=Math.min(Math.min(c,k),Math.min(a,e)),c=Math.max(Math.max(c,k),Math.max(a,e));return new _geo.geotoolkit.util.Rect(b,h,f,c)};b.prototype.contains=function(a){a=this.iN().cb(a);return this.r.contains(a)};b.prototype.je=
function(a){return this.iN().cb(a)};b.prototype.transform=function(a){return this.dd.cb(a)};b.prototype.J8=function(a,b){return this.lZb(a,b)};return b}();
_geo.geotoolkit.kd.$ya=function(){function b(a,b){_geo.geotoolkit.kd.Zfb.call(this);this.YJ=a;this.AAa=new _geo.geotoolkit.util.na;this.EBa=new _geo.geotoolkit.util.na;this.DBa=new _geo.geotoolkit.util.na;this.zAa=new _geo.geotoolkit.util.na;this.CR=this.BR=1;this.ILb=null;this.tmc=b}_geo.geotoolkit.fa(b,_geo.geotoolkit.kd.Zfb);_geo.geotoolkit.da(b,"geotoolkit.deviation.TrajectoryStation");b.prototype.di=function(){return this.AAa};b.prototype.MOc=function(a){this.AAa.bb(a.getX(),a.getY())};b.prototype.zr=
function(){return this.zAa};b.prototype.LOc=function(a){this.zAa.bb(a.getX(),a.getY())};b.prototype.st=function(){return this.EBa};b.prototype.SPc=function(a){this.EBa.bb(a.getX(),a.getY())};b.prototype.Sn=function(){return this.DBa};b.prototype.RPc=function(a){this.DBa.bb(a.getX(),a.getY())};b.prototype.nf=function(){return this.YJ.qa()};b.prototype.gPc=function(a){a=Math.min(this.YJ.wa(),a);this.YJ.zb(this.YJ.sa(),a,this.YJ.za(),this.YJ.wa());this.update()};b.prototype.Cf=function(){return this.YJ.wa()};
b.prototype.aPc=function(a){a=Math.max(this.YJ.qa(),a);this.YJ.zb(this.YJ.sa(),this.YJ.qa(),this.YJ.za(),a);this.update()};b.prototype.Lm=function(){return this.YJ};b.prototype.$ab=function(a){this.YJ=a};b.prototype.yxd=function(){return this.YJ};b.prototype.cAd=function(a){this.YJ=a};b.prototype.o_=function(){return this.BR};b.prototype.pUa=function(a){this.BR=a};b.prototype.p_=function(){return this.CR};b.prototype.qUa=function(a){this.CR=a};b.prototype.N9=function(){return this.tmc};b.prototype.nmd=
function(a){this.ILb=a};b.prototype.offset=function(a){var b=a.getX();a=a.getY();this.AAa.bb(this.AAa.getX()+b,this.AAa.getY()+a);this.EBa.bb(this.EBa.getX()+b,this.EBa.getY()+a);this.DBa.bb(this.DBa.getX()+b,this.DBa.getY()+a);this.zAa.bb(this.zAa.getX()+b,this.zAa.getY()+a)};b.prototype.update=function(){this.zPb()};b.prototype.J8=function(a,b){var d=null;if(this.tmc&&null!=this.ILb)var d=this.je(a),e=this.YJ.wa(),c=this.YJ.qa(),d=(d.y-c)/(e-c),d=0>d?this.ILb.J8(a,b):this.lZb(a,b);else d=this.lZb(a,
b);return d};b.prototype.j_=function(){var a=(this.AAa.x+this.EBa.x)/2,b=(this.AAa.y+this.EBa.y)/2,d=(this.zAa.x+this.DBa.x)/2,e=(this.zAa.y+this.DBa.y)/2;return Math.sqrt((a-d)*(a-d)+(b-e)*(b-e))};b.prototype.contains=_geo.geotoolkit.Ia;b.prototype.transform=_geo.geotoolkit.Ia;b.prototype.B5=_geo.geotoolkit.Ia;b.prototype.w7b=_geo.geotoolkit.Ia;b.prototype.Tfa=_geo.geotoolkit.Ia;b.prototype.Vfa=_geo.geotoolkit.Ia;return b}();
_geo.geotoolkit.kd.lfb=function(){function b(b,e,c){_geo.geotoolkit.kd.$ya.call(this,e,c);this.UL=null;this.dd=new _geo.geotoolkit.util.Ga;null!=b&&this.dd.kc(b);this.Hm=new _geo.geotoolkit.util.Ga;this.$x=new a;this.fA=new a;this.ZKb=2;this.ira=new a}var a=_geo.geotoolkit.util.na,g=_geo.geotoolkit.kd.Bb;_geo.geotoolkit.fa(b,_geo.geotoolkit.kd.$ya);_geo.geotoolkit.da(b,"geotoolkit.deviation.LinearTrajectoryStation");b.prototype.ckd=function(){return this.ZKb};b.prototype.Upb=function(){this.ZKb--};
b.prototype.Jxd=function(){this.ZKb++};b.prototype.j_=function(){return a.Cj(this.$x,this.fA)};b.prototype.lqd=function(){return this.$x};b.prototype.Hcd=function(){return this.fA};b.prototype.iN=function(){return this.UL=this.UL||this.dd.Vd()};b.prototype.Ra=function(){return this.dd};b.prototype.kc=function(a){this.dd.kc(a);this.UL=null;this.zPb()};b.prototype.ypd=function(a){this.Hm.kc(a)};b.prototype.offset=function(a){_geo.geotoolkit.kd.$ya.prototype.offset.call(this,a);var b=a.getX();a=a.getY();
this.dd.GD(this.dd.ti()+b,this.dd.Th()+a);this.N9()&&this.Hm.GD(this.Hm.ti()+b,this.Hm.Th()+a);this.UL=null;this.$x.bb(this.$x.getX()+b,this.$x.getY()+a);this.fA.bb(this.fA.getX()+b,this.fA.getY()+a)};b.prototype.contains=function(b){if(!this.N9())return b=this.iN().cb(b),this.Lm().contains(b);if(this.di().getY()<=this.zr().getY()===this.st().getY()<=this.Sn().getY())return g.Sgd(b,this.zr(),this.Sn(),this.st(),this.di());var e=new a;return g.vQb(this.di(),this.st(),this.zr(),this.Sn(),e)?g.vGc(b,
this.di(),this.zr(),e)||g.vGc(b,this.st(),this.Sn(),e):!1};b.prototype.je=function(b){if(!this.N9())return this.iN().cb(b);var e=new a,c=new a;if(!g.vQb(this.di(),this.st(),this.zr(),this.Sn(),e)||!g.vQb(this.$x,this.fA,e,b,c))return b.clone();if(c.getY()<Math.min(this.$x.getY(),this.fA.getY()))return this.Lm().di();if(c.getY()>Math.max(this.$x.getY(),this.fA.getY()))return this.Lm().Sn();e=g.getLength(this.ira.bb(this.fA.getX()-this.$x.getX(),this.fA.getY()-this.$x.getY()));c=Math.abs(e)>_geo.geotoolkit.util.Math.Jc?
g.getLength(this.ira.bb(c.getX()-this.$x.getX(),c.getY()-this.$x.getY()))/e:Number.MAX_VALUE;e=c*this.dd.Ab()+(1-c)*this.Hm.Ab();b=Math.abs(e)<=_geo.geotoolkit.util.Math.Jc?Number.MAX_VALUE:(b.getX()-c*(this.dd.Qi()*this.Lm().wa()+this.dd.ti())-(1-c)*(this.Hm.Qi()*this.Lm().qa()+this.Hm.ti()))/e;c=c*this.Lm().wa()+(1-c)*this.Lm().qa();return new a(b,c)};b.prototype.transform=function(b){if(!this.N9())return this.dd.cb(b);var e=this.Lm().wa(),c=this.Lm().qa(),g=e-c;if(Math.abs(g)<_geo.geotoolkit.util.Math.Jc)return b.getY()<
c?this.Hm.cb(b):this.dd.cb(b);g=(b.getY()-c)/g;if(0>=g)return this.Hm.cb(b);if(1<=g)return this.dd.cb(b);var k=this.Hm.Ab()*b.getX()+this.Hm.Qi()*c+this.Hm.ti(),h=this.dd.Ab()*b.getX()+this.dd.Qi()*e+this.dd.ti(),c=this.Hm.rj()*b.getX()+this.Hm.Pb()*c+this.Hm.Th();b=this.dd.rj()*b.getX()+this.dd.Pb()*e+this.dd.Th();return new a((h-k)*g+k,(b-c)*g+c)};b.prototype.update=function(){_geo.geotoolkit.kd.$ya.prototype.update.call(this);this.UL=null;var b=this.Lm(),e=this.N9()?this.Hm:this.dd;this.$x=e.cb(new a(b.Pc(),
b.qa()));this.fA=this.dd.cb(new a(b.Pc(),b.wa()));this.MOc(e.cb(b.di()));this.SPc(e.cb(b.st()));this.RPc(this.dd.cb(b.Sn()));this.LOc(this.dd.cb(b.zr()));0===this.dd.Ab()?this.pUa(Math.abs(this.dd.rj())):0===this.dd.rj()?this.pUa(Math.abs(this.dd.Ab())):this.pUa(Math.sqrt(this.dd.Ab()*this.dd.Ab()+this.dd.rj()*this.dd.rj()));0===this.dd.Pb()?this.qUa(Math.abs(this.dd.Qi())):0===this.dd.Qi()?this.qUa(Math.abs(this.dd.Pb())):this.qUa(Math.sqrt(this.dd.Pb()*this.dd.Pb()+this.dd.Qi()*this.dd.Qi()));this.N9()&&
(0===this.Hm.Ab()?this.pUa(Math.max(this.o_(),Math.abs(this.Hm.rj()))):0===this.Hm.rj()?this.pUa(Math.max(this.o_(),Math.abs(this.Hm.Ab()))):this.pUa(Math.max(this.o_(),Math.sqrt(this.Hm.Ab()*this.Hm.Ab()+this.Hm.rj()*this.Hm.rj()))),0===this.Hm.Pb()?this.qUa(Math.max(this.p_(),Math.abs(this.Hm.Qi()))):0===this.Hm.Qi()?this.qUa(Math.max(this.p_(),Math.abs(this.Hm.Pb()))):this.qUa(Math.max(this.p_(),Math.sqrt(this.Hm.Pb()*this.Hm.Pb()+this.Hm.Qi()*this.Hm.Qi()))))};b.prototype.Tfa=function(a){if(!this.N9())return 0===
this.dd.Ab()?Math.abs(this.dd.rj()):0===this.dd.rj()?Math.abs(this.dd.Ab()):Math.sqrt(this.dd.Ab()*this.dd.Ab()+this.dd.rj()*this.dd.rj());a=this.lsc(a);return 0===a.Ab()?Math.abs(a.rj()):0===a.rj()?Math.abs(a.Ab()):Math.sqrt(a.Ab()*a.Ab()+a.rj()*a.rj())};b.prototype.Vfa=function(a){if(!this.N9())return 0===this.dd.Pb()?Math.abs(this.dd.Qi()):0===this.dd.Qi()?Math.abs(this.dd.Pb()):Math.sqrt(this.dd.Pb()*this.dd.Pb()+this.dd.Qi()*this.dd.Qi());a=this.lsc(a);return 0===a.Pb()?Math.abs(a.Qi()):0===
a.Qi()?Math.abs(a.Pb()):Math.sqrt(a.Pb()*a.Pb()+a.Qi()*a.Qi())};b.prototype.lsc=function(a){if(!this.N9())return this.dd;var b=this.Lm().wa(),c=this.Lm().qa(),g=b-c;if(Math.abs(g)<_geo.geotoolkit.util.Math.Jc)return a.getY()<c?this.Hm:this.dd;var k=(a.getY()-c)/g;if(0>=k)return this.Hm;if(1<=k)return this.dd;if(Math.abs(a.getY())<=_geo.geotoolkit.util.Math.Jc){a=this.dd.Qi()*b+this.dd.ti();var h=this.dd.Pb()*b+this.dd.Th(),l=this.Hm.Qi()*c+this.Hm.ti(),n=this.Hm.Pb()*c+this.Hm.Th();return new _geo.geotoolkit.util.Ga(this.dd.Ab()*
k+this.Hm.Ab()*(1-k),this.dd.rj()*k+this.Hm.rj()*(1-k),(a-l)/g,(h-n)/g,(l*b-a*c)/g,(n*b-h*c)/g)}return new _geo.geotoolkit.util.Ga(this.dd.Ab()*k+this.Hm.Ab()*(1-k),this.dd.rj()*k+this.Hm.rj()*(1-k),(this.dd.Qi()*k*b+this.Hm.Qi()*(1-k)*c)/a.getY(),(this.dd.Pb()*k*b+this.Hm.Pb()*(1-k)*c)/a.getY(),this.dd.ti()*k+this.Hm.ti()*(1-k),this.dd.Th()*k+this.Hm.Th()*(1-k))};b.prototype.B5=function(a,b,c,f,k){var h=this.Lm(),l=_geo.geotoolkit.util.Math.Jc;h.qa()<=a.getY()+l&&h.wa()>=a.getY()-l&&g.zw(f,this.transform(a),
c,k);h.qa()>a.getY()-l&&h.qa()<b.getY()+l&&g.zw(f,this.transform(g.WP(a,b,h.qa())),c,k);h.wa()>a.getY()-l&&h.wa()<b.getY()+l&&g.zw(f,this.transform(g.WP(a,b,h.wa())),c,k);h.qa()<=b.getY()+l&&h.wa()>=b.getY()-l&&g.zw(f,this.transform(b),c,k)};b.prototype.w7b=function(a,b,c,f,k){var h=this.Lm();h.qa()<=a.getY()&&h.wa()>=a.getY()&&g.zw(f,this.transform(a),c,k);h.wa()>b.getY()&&h.wa()<a.getY()&&g.zw(f,this.transform(g.WP(a,b,h.wa())),c,k);h.qa()>b.getY()&&h.qa()<a.getY()&&g.zw(f,this.transform(g.WP(a,
b,h.qa())),c,k);h.qa()<=b.getY()&&h.wa()>=b.getY()&&g.zw(f,this.transform(b),c,k)};return b}();_geo.geotoolkit.kd.bt=function(){function b(a,b){this.sna=void 0!==a?a:-1;this.Y_=b||new _geo.geotoolkit.util.Rect;this.YHa=Number.MAX_VALUE}_geo.geotoolkit.da(b,"geotoolkit.deviation.StationBounds");return b}();_geo.geotoolkit.kd.Ahc=function(){function b(a,b){this.vfb=a;this.bt=b}_geo.geotoolkit.da(b,"geotoolkit.deviation.StationPair");return b}();
_geo.geotoolkit.kd.Zfc=function(){function b(){this.el=[]}_geo.geotoolkit.da(b,"geotoolkit.deviation.RectMap");b.prototype.Dla=function(){return this.el};b.prototype.clear=function(){this.el=[];return this};b.prototype.uSa=function(a){for(var b=0;b<this.el.length;b++){var d=this.el[b];if(a<=d.vfb)return b}return this.el.length};b.prototype.Jrd=function(a){for(var b=this.el.length-1;0<=b;b--)if(this.el[b].vfb<=a)return b;return 0};b.prototype.gs=function(a){var b=a.vfb;if(0===this.el.length)this.el.push(a);
else{var d;for(d=0;d<this.el.length&&!(this.el[d].vfb>=b);d++);this.el.splice(d,0,a)}};return b}();
_geo.geotoolkit.kd.g_c=function(){function b(a){this.CMb=a}function a(a,b,e){this.DD=a;this.n$a=b;this.qua=void 0!==e?e:-1}_geo.geotoolkit.da(b,"geotoolkit.deviation.PiecewiseApproximator");b.prototype.vOb=function(b,d){var e=_geo.geotoolkit.util.na,c=[];c.push(new a(b,this.CMb.transform(b),1));c.push(new a(d,this.CMb.transform(d),-1));for(var f=0;-1!==c[f].qua;){var k=c[f],h=c[k.qua],l=e.Cj(k.n$a,h.n$a);if(1>l)f=k.qua;else{var n=new e((k.DD.getX()+h.DD.getX())/2,(k.DD.getY()+h.DD.getY())/2),p=this.CMb.transform(n),
r=k.qua,h=new _geo.geotoolkit.kd.Line(k.n$a,h.n$a),l=h.distance(p);.5>Math.abs(l)?f=k.qua:(k.qua=c.length,c.push(new a(n,p,r)))}}return c};return b}();
_geo.geotoolkit.kd.yEb=function(){function b(){_geo.geotoolkit.kd.$ya.call(this,new _geo.geotoolkit.util.Rect,!0);this.Uy=this.xza=this.mMb=this.Xib=this.fg=this.Sra=this.COa=this.H1a=this.b2a=this.GR=this.xlb=this.Tlb=null;this.B2c=new _geo.geotoolkit.kd.g_c(this);this.Jj=this.HF=null;this.Oj=window.NaN}var a=_geo.geotoolkit.util.na,g=_geo.geotoolkit.util.Ga,d=_geo.geotoolkit.kd.Bb,e=_geo.geotoolkit.kd.Line;_geo.geotoolkit.da(b,"geotoolkit.deviation.PieSliceTrajectoryStation");_geo.geotoolkit.fa(b,
_geo.geotoolkit.kd.$ya);b.prototype.j_=function(){return this.Oj};b.uad=function(c,f){if(c.N9()||f.N9())return null;var k=f.Lm(),h=c.Lm(),l,n,p,r,t=d.Qrd(new a(f.zr().getX()-f.di().getX(),f.zr().getY()-f.di().getY()),new a(c.zr().getX()-c.di().getX(),c.zr().getY()-c.di().getY()));if(Math.abs(t)<_geo.geotoolkit.util.Math.Jc)return null;(t=0>t)?(l=new e(c.di(),c.zr()),n=new e(f.di(),f.zr()),p=h.sa(),r=h.za()-p):(l=new e(c.st(),c.Sn()),n=new e(f.st(),f.Sn()),p=h.za(),r=h.sa()-p);if(e.s8c(l,n))return null;
l=e.TKc(n,l);n=c.je(l);var q=f.je(l);if(h.qa()>n.getY()||k.wa()<q.getY())return h.qa()>n.getY()?-1:1;c.aPc(n.getY());f.gPc(q.getY());var m=t?c.Sn():c.zr(),k=new a(m.getX()-l.getX(),m.getY()-l.getY()),m=t?f.st():f.di(),m=new a(m.getX()-l.getX(),m.getY()-l.getY()),u=Math.atan2(k.getY(),k.getX()),v=g.dn(-u,0,0),w=g.kj(-l.getX(),-l.getY()),w=g.multiply(v,w),v=v.cb(m),m=new b;m.xza=Math.atan2(v.getY(),v.getX());m.Xib=w;m.mMb=w.Vd();m.COa=p;m.Sra=r;m.GR=l;m.fg=a.Cj(k,new a(0,0));m.Uy=u;m.MOc(c.zr());m.SPc(c.Sn());
m.LOc(f.di());m.RPc(f.st());m.Oj=Math.abs(m.fg*m.xza/2);m.$ab(new _geo.geotoolkit.util.Rect(h.sa(),n.getY(),h.za(),q.getY()));h=new e(l,t?c.Sn():c.zr());p=new e(l,t?f.st():f.di());0<h.distance(t?f.st():f.di())?(m.Tlb=h,m.xlb=p,t?(t=c.Sn(),h=f.st()):(t=c.zr(),h=f.di())):(m.Tlb=p,m.xlb=h,t?(h=c.Sn(),t=f.st()):(h=c.zr(),t=f.di()));m.b2a=new a(t.getX(),t.getY());m.H1a=new a(h.getX(),h.getY());return m};b.prototype.update=function(a,b){this.$ab(new _geo.geotoolkit.util.Rect(a.Lm().sa(),a.Cf(),a.Lm().za(),
b.nf()))};b.prototype.offset=function(a){_geo.geotoolkit.kd.$ya.prototype.offset.call(this,a);var b=a.getX();a=a.getY();this.GR.bb(this.GR.getX()+b,this.GR.getY()+a);this.b2a.bb(this.b2a.getX()+b,this.b2a.getY()+a);this.H1a.bb(this.H1a.getX()+b,this.H1a.getY()+a);b=g.dn(-this.Uy,0,0);a=g.kj(-this.GR.getX(),-this.GR.getY());this.Xib=g.multiply(b,a);this.mMb=this.Xib.Vd();this.Tlb.Dw(this.GR,this.b2a);this.xlb.Dw(this.GR,this.H1a)};b.prototype.contains=function(b){return a.Cj(this.GR,b)<=this.fg&&0<
this.Tlb.distance(b)&&0>this.xlb.distance(b)};b.prototype.je=function(b){var d=b.getX(),e=b.getY();Math.abs(this.fg)>_geo.geotoolkit.util.Math.Jc&&(d=this.COa+this.Sra*(a.Cj(b,this.GR)/this.fg));b=this.Xib.cb(b);Math.abs(this.xza)>_geo.geotoolkit.util.Math.Jc&&(e=this.Lm().qa()+Math.atan2(b.getY(),b.getX())/this.xza*this.Lm().ba());return new a(d,e)};b.prototype.transform=function(b){var d=Math.abs(this.Sra)>_geo.geotoolkit.util.Math.Jc?(b.getX()-this.COa)/this.Sra:b.getX()-this.COa;b=this.Lm().ba()>
_geo.geotoolkit.util.Math.Jc?(b.getY()-this.Lm().qa())/this.Lm().ba():b.getY()-this.Lm().qa();b=g.dn(this.xza*b,0,0);d=new a(this.fg*d,0);return this.mMb.cb(b.cb(d))};b.prototype.Tfa=function(a){return Math.abs(this.Sra)>_geo.geotoolkit.util.Math.Jc?Math.abs(this.fg/this.Sra):Math.abs(this.fg)};b.prototype.Vfa=function(a){a=Math.abs(this.Sra)>_geo.geotoolkit.util.Math.Jc?(a.getX()-this.COa)/this.Sra:a.getX()-this.COa;return this.Lm().ba()>_geo.geotoolkit.util.Math.Jc?Math.abs(this.xza*this.fg*a/this.Lm().ba()):
Math.abs(this.xza*this.fg*a)};b.prototype.B5=function(a,b,e,g,l){if(_geo.geotoolkit.kd.Bb.sKc(a.getY(),b.getY()))this.LGc(a,b,e,g,l);else{this.HF=!0;var n=this.Lm();n.qa()<=a.getY()&&n.wa()>=a.getY()&&this.Dl(g,a,e,l);n.qa()>a.getY()&&n.qa()<b.getY()&&this.Dl(g,d.WP(a,b,n.qa()),e,l);n.wa()>a.getY()&&n.wa()<b.getY()&&this.Dl(g,d.WP(a,b,n.wa()),e,l);n.qa()<=b.getY()&&n.wa()>=b.getY()&&this.Dl(g,b,e,l)}};b.prototype.w7b=function(a,b,e,g,l){if(_geo.geotoolkit.kd.Bb.sKc(a.getY(),b.getY()))this.LGc(a,b,
e,g,l);else{this.HF=!0;var n=this.Lm();n.qa()<=a.getY()&&n.wa()>=a.getY()&&this.Dl(g,a,e,l);n.wa()>b.getY()&&n.wa()<a.getY()&&this.Dl(g,d.WP(a,b,n.wa()),e,l);n.qa()>b.getY()&&n.qa()<a.getY()&&this.Dl(g,d.WP(a,b,n.qa()),e,l);n.qa()<=b.getY()&&n.wa()>=b.getY()&&this.Dl(g,b,e,l)}};b.prototype.Dl=function(a,b,e,g){if(this.HF)d.zw(a,this.transform(b),e,g),this.Jj=b&&b.clone(),this.HF=!1;else{b=this.B2c.vOb(this.Jj,b);var l=0;do l=b[l].qua,d.zw(a,b[l].n$a,e,g);while(-1!==b[l].qua)}};b.prototype.LGc=function(a,
b,e,g,l){d.zw(g,this.transform(a),e,l);d.zw(g,this.transform(b),e,l)};return b}();
_geo.geotoolkit.kd.cJa=function(){function b(){}_geo.geotoolkit.da(b,"geotoolkit.deviation.DeviatedTransformation");b.prototype.update=_geo.geotoolkit.Ia;b.prototype.transform=_geo.geotoolkit.Ia;b.prototype.je=_geo.geotoolkit.Ia;b.prototype.B5=_geo.geotoolkit.Ia;b.prototype.YI=_geo.geotoolkit.Ia;b.prototype.zDa=_geo.geotoolkit.Ia;b.prototype.contains=_geo.geotoolkit.Ia;b.prototype.Tfa=_geo.geotoolkit.Ia;b.prototype.Vfa=_geo.geotoolkit.Ia;b.prototype.Vsc=_geo.geotoolkit.Ia;b.prototype.KWb=function(){return{xMin:this.lW(),
yMin:this.mW(),xMean:this.Tub(),yMean:this.Uub(),xMax:this.o_(),yMax:this.p_()}};b.prototype.o_=_geo.geotoolkit.Ia;b.prototype.p_=_geo.geotoolkit.Ia;b.prototype.lW=_geo.geotoolkit.Ia;b.prototype.mW=_geo.geotoolkit.Ia;b.prototype.Tub=function(){var a=this.lW(),b=this.o_();return Math.sqrt((a*a+b*b)/2)};b.prototype.Uub=function(){var a=this.mW(),b=this.p_();return Math.sqrt((a*a+b*b)/2)};b.prototype.J8=_geo.geotoolkit.Ia;b.prototype.yea=_geo.geotoolkit.Ia;return b}();
_geo.geotoolkit.kd.bLa=function(){function b(){}_geo.geotoolkit.da(b,"geotoolkit.deviation.Transformer2d");b.prototype.create=_geo.geotoolkit.Ia;return b}();
_geo.geotoolkit.kd.Vhc=function(){function b(a,b,c){_geo.geotoolkit.kd.cJa.call(this);this.Ye=a.transformation||c;this.Fq=a.trajectory;this.hx=a.trackWidth;this.sB=a.filter;this.ud=a.offset;b=_geo.geotoolkit.Ca(b,{scaleWidth:!1,minWidth:-Number.MAX_VALUE,maxWidth:Number.MAX_VALUE,widthScaleX:1});this.jMb=b.scaleWidth;this.FKb=b.minWidth;this.Oqa=b.maxWidth;this.Rnb=b.widthScaleX;this.lf=[];this.UF=new _geo.geotoolkit.kd.Zfc;this.zca=this.yca=this.CR=this.BR=1;this.oqc=new _geo.geotoolkit.util.Ga;
this.pqc=new _geo.geotoolkit.util.Ga;this.pva()}var a=_geo.geotoolkit.util.na,g=_geo.geotoolkit.kd.Bb;_geo.geotoolkit.fa(b,_geo.geotoolkit.kd.cJa);_geo.geotoolkit.da(b,"geotoolkit.deviation.TVDTransformation");b.prototype.yea=function(a){var b=this.lf.length,c=_geo.geotoolkit.util.Math.findIndex(null,this.lf,0,b,function(b){b=b.r.wa()-a;return Math.abs(b)>_geo.geotoolkit.util.Math.Jc?b:0});0>c?c=~c:++c;c>=b&&(c=b-1);return c};b.prototype.update=function(a){if(Math.abs(a.Ab()-this.Ye.Ab())>_geo.geotoolkit.util.Math.Jc||
Math.abs(a.Pb()-this.Ye.Pb())>_geo.geotoolkit.util.Math.Jc)this.Ye=a,this.pva();else{var b=a.ti()-this.Ye.ti(),c=a.Th()-this.Ye.Th();if(Math.abs(b)>_geo.geotoolkit.util.Math.Jc||Math.abs(c)>_geo.geotoolkit.util.Math.Jc){for(var g=0;g<this.lf.length;++g)this.lf[g].offset(b,c);this.oqc.kc(1,0,0,1,b,c);b=this.UF.Dla();for(c=0;c<b.length;++c)g=b[c],this.oqc.ob(g.bt.Y_,g.bt.Y_)}this.Ye=a}return!0};b.prototype.transform=function(a){var b=this.yea(a.getY());for(0>b&&(b=0);b<this.lf.length;++b){if(a.getY()<=
this.lf[b].r.wa()&&a.getY()>=this.lf[b].r.qa())return this.lf[b].transform(a);if(this.lf[b].r.wa()>a.getY())break}return new _geo.geotoolkit.util.na};b.prototype.je=function(a){for(var b=this.UF.Dla(),c=this.UF.uSa(a.getY()-this.Ye.Th());c<b.length;++c){var g=b[c];if(this.lf[g.bt.sna].contains(a))return this.lf[g.bt.sna].je(a);if(a.getY()<g.bt.Y_.wa())break}return new _geo.geotoolkit.util.na};b.prototype.B5=function(b,e,c){if(0!==this.lf.length){var f=new a,k=this.yea(b.getY()),h;if(b.getY()<=e.getY())for(;k<
this.lf.length&&!(h=this.lf[k],h.r.qa()<=b.getY()&&h.r.wa()>=b.getY()&&g.zw(c,h.transform(b),f,this.sB),h.r.qa()>=b.getY()&&h.r.qa()<=e.getY()&&g.zw(c,h.transform(g.WP(b,e,h.r.qa())),f,this.sB),k===this.lf.length-1&&h.r.wa()>=b.getY()&&h.r.wa()<=e.getY()&&g.zw(c,h.transform(g.WP(b,e,h.r.wa())),f,this.sB),h.r.qa()<=e.getY()&&h.r.wa()>=e.getY()&&g.zw(c,h.transform(e),f,this.sB),h.r.wa()>=e.getY());++k);else for(k>=this.lf.length&&(k=this.lf.length-1);0<=k&&!(h=this.lf[k],h.r.qa()<=b.getY()&&h.r.wa()>=
b.getY()&&g.zw(c,h.transform(b),f,this.sB),h.r.wa()>=e.getY()&&h.r.wa()<=b.getY()&&g.zw(c,h.transform(g.WP(b,e,h.r.wa())),f,this.sB),0===k&&h.r.qa()>=e.getY()&&h.r.qa()<=b.getY()&&g.zw(c,h.transform(g.WP(b,e,h.r.qa())),f,this.sB),h.r.qa()<=e.getY()&&h.r.wa()>=e.getY()&&g.zw(c,h.transform(e),f,this.sB),h.r.qa()<=e.getY());--k);}};b.prototype.YI=function(b,e,c,f){var k=b.length;if(1<k&&0<this.lf.length){(f=f&&!g.aKc(b,k))&&++k;var h,l,n;c?(h=c.Ab(),l=c.Pb(),n=c.ti(),c=c.Th()):(l=h=1,c=n=0);for(var p=
new a,r=new a(b[0].getX()*h+n,b[0].getY()*l+c),t=new a,q=0,m=0,u,v=0;v<k-1;++v){u=f&&v===k-2?0:v+1;t.bb(b[u].getX()*h+n,b[u].getY()*l+c);if(0>q||q>=this.lf.length||!(this.lf[q].r.qa()<=r.getY()&&this.lf[q].r.wa()>=r.getY()))q=this.yea(r.getY());if(r.getY()<=t.getY())for(;q<this.lf.length&&!(u=this.lf[q],0===v&&u.r.qa()<=r.getY()&&u.r.wa()>=r.getY()&&g.zw(e,u.transform(r),p,this.sB),u.r.qa()>r.getY()&&u.r.qa()<t.getY()&&g.zw(e,u.transform(g.WP(r,t,u.r.qa())),p,this.sB),q===this.lf.length-1&&u.r.wa()>
r.getY()&&u.r.wa()<t.getY()&&g.zw(e,u.transform(g.WP(r,t,u.r.wa())),p,this.sB),u.r.qa()<=t.getY()&&u.r.wa()>=t.getY()&&(g.zw(e,u.transform(t),p,this.sB),m=q),u.r.wa()>=t.getY());++q);else for(q>=this.lf.length&&(q=this.lf.length-1);0<=q&&!(u=this.lf[q],0===v&&u.r.qa()<=r.getY()&&u.r.wa()>=r.getY()&&g.zw(e,u.transform(r),p,this.sB),u.r.wa()>t.getY()&&u.r.wa()<r.getY()&&g.zw(e,u.transform(g.WP(r,t,u.r.wa())),p,this.sB),0===q&&u.r.qa()>t.getY()&&u.r.qa()<r.getY()&&g.zw(e,u.transform(g.WP(r,t,u.r.qa())),
p,this.sB),u.r.qa()<=t.getY()&&u.r.wa()>=t.getY()&&(g.zw(e,u.transform(t),p,this.sB),m=q),u.r.qa()<=t.getY());--q);q=m;r.bb(t.getX(),t.getY())}}};b.prototype.zDa=function(a){return 1>this.lf.length?new _geo.geotoolkit.util.Rect:new _geo.geotoolkit.util.Rect(0,a.qa(),this.hx,a.wa())};b.prototype.contains=function(a){for(var b=this.UF.Dla(),c=this.UF.uSa(a.getY()-this.Ye.Th());c<b.length;++c){var g=b[c];if(g.bt.Y_.contains(a)&&this.lf[g.bt.sna].contains(a))return!0;if(a.getY()<g.bt.Y_.wa())break}return!1};
b.prototype.Tfa=function(a){return this.BR};b.prototype.Vfa=function(a){return this.CR};b.prototype.o_=function(){return this.BR};b.prototype.p_=function(){return this.CR};b.prototype.lW=function(){return this.yca};b.prototype.mW=function(){return this.zca};b.prototype.J8=function(a,b){var c=this.yea(a.getY());for(0>c&&(c=0);c<this.lf.length;++c){if(a.getY()<=this.lf[c].r.wa()&&a.getY()>=this.lf[c].r.qa())return this.lf[c].J8(a,b);if(this.lf[c].r.wa()>a.getY())break}return null};b.prototype.z1b=function(a){return this.jMb};
b.prototype.pva=function(){this.lf=[];this.UF.clear();for(var b=0,e=this.z1b(Math.abs(this.Ye.Ab())),c=1;c<this.Fq.count();++c)if(!(this.Fq.getY(b)>=this.Fq.getY(c))){var f=this.Fq.getX(b),k=this.Fq.getY(b),h=this.Fq.getX(c),l=this.Fq.getY(c);if(1<c&&c<this.Fq.count()-1){var n=new a(f,k),p=new a(h,l),r=this.Ye.cb(n),t=this.Ye.cb(p);if(.5>Math.abs(r.getX()-t.getX())&&.5>Math.abs(r.getY()-t.getY()))continue;if(1<b&&(r=new a(this.Fq.getX(b-1),this.Fq.getY(b-1)),g.uGc(r,p,n)))continue}h=(h-f)/(l-k);f-=
h*k;k=new _geo.geotoolkit.kd.q1c;this.pqc.kc(e,0,h,1,f,0);k.kc(_geo.geotoolkit.util.Ga.multiply(this.Ye,this.pqc));k.r=new _geo.geotoolkit.util.Rect(0,this.Fq.getY(b),this.hx,this.Fq.getY(c));this.pob(k);b=c}this.BR=Math.abs(e*this.Ye.Ab());this.CR=Math.abs(this.Ye.Pb());this.yca=Math.abs(e*this.Ye.Ab());this.zca=Math.abs(this.Ye.Pb())};b.prototype.pob=function(a){var b=a.Oqd(),c=new _geo.geotoolkit.kd.bt(this.lf.length,b),b=b.wa()-this.Ye.Th();this.UF.gs(new _geo.geotoolkit.kd.Ahc(b,c));this.lf.push(a)};
b.prototype.VSb=function(){return this.Ye};return b}();
_geo.geotoolkit.kd.Whc=function(){function b(a){_geo.geotoolkit.kd.bLa.call(this);this.la=_geo.geotoolkit.Ca(a,{scaleWidth:!1,minWidth:-Number.MAX_VALUE,maxWidth:Number.MAX_VALUE,widthScaleX:1})}_geo.geotoolkit.fa(b,_geo.geotoolkit.kd.bLa);_geo.geotoolkit.da(b,"geotoolkit.deviation.TVDTransformer");b.prototype.jb=function(){return _geo.geotoolkit.Ca(this.la,{})};b.prototype.setOptions=function(a){_geo.geotoolkit.Ca(a,this.la)};b.prototype.create=function(a,b){return new _geo.geotoolkit.kd.Vhc(a,this.la,
b)};return b}();
_geo.geotoolkit.kd.gfc=function(){function b(a,b,d,e){this.vJ=a?a:0;this.DH=b?b:0;this.eIb=d?d:0;this.xu=e?e:null}_geo.geotoolkit.da(b,"geotoolkit.deviation.PiecewiseLinearApproximation");b.prototype.line=function(){return this.xu};b.prototype.error=function(){return this.eIb};b.prototype.D8c=function(){return this.vJ};b.prototype.VRb=function(){return this.DH};b.prototype.count=function(){return this.DH-this.vJ+1};b.prototype.copy=function(a){this.vJ=a.vJ;this.DH=a.DH;this.eIb=a.eIb;this.xu=a.xu;
return this};return b}();
_geo.geotoolkit.kd.h_c=function(){function b(a,b,e){this.Fq=a;this.$6c=b;this.ujb=e;this.Ipa=0;this.Qja=null==a?0:a.count();this.GR=new _geo.geotoolkit.kd.gfc;this.Okc=[];for(a=0;a<this.Qja;++a)this.Okc[a]=this.$6c.cb(this.Pjd(a));this.next()}function a(){this.S4c=new _geo.geotoolkit.util.na;this.AR=new _geo.geotoolkit.util.na;this.jnc=this.CKb=0;this.amb=new _geo.geotoolkit.util.na}_geo.geotoolkit.da(b,"geotoolkit.deviation.PiecewiseLinearIteratorImpl");b.prototype.wsa=function(a){return 0<=a&&a<
this.Qja?this.Okc[a]:new _geo.geotoolkit.util.na};b.prototype.Pjd=function(a){return 0<=a&&a<this.Qja?new _geo.geotoolkit.util.na(this.Fq.getX(a),this.Fq.getY(a)):new _geo.geotoolkit.util.na};b.prototype.depth=function(a){return 0<=a&&a<this.Qja?this.Fq.wc(a):0};b.prototype.object=function(){return this.GR};b.prototype.end=function(){return 0===this.Qja||this.Ipa===this.Qja-1};b.prototype.next=function(){this.GR.VRb()&&(this.Ipa=this.GR.VRb());this.end()||(this.GR=this.vOb())};b.prototype.center=
function(a,b){for(var e=0,c=0,f=b-a+1,k=a;k<=b;++k)var h=this.wsa(k),e=e+h.getX(),c=c+h.getY();return new _geo.geotoolkit.util.na(e/f,c/f)};b.prototype.CIc=function(a,b,e){for(var c=this.center(a,b),f=0,k=0,h=0;a<=b;++a)var l=this.wsa(a),n=l.getX()-c.getX(),l=l.getY()-c.getY(),f=f+l*l,k=k-n*l,h=h+n*n;e.amb=c;b=f+h;f=.5*(f-h);h=Math.sqrt(k*k+f*f);e.jnc=.5*b+h;e.AR.bb(-k,f-h);k=_geo.geotoolkit.kd.Bb.aHa(e.AR,e.AR);0===k?e.AR.bb(1,0):(k=Math.sqrt(k),e.AR.bb(e.AR.getX()/k,e.AR.getY()/k));e.CKb=b-e.jnc;
e.S4c=new _geo.geotoolkit.util.na(-e.AR.getY(),e.AR.getX())};b.prototype.jRb=function(a,b,e,c,f){a=b*(this.depth(e)-a);c=_geo.geotoolkit.util.na.Cj(f,c);return Math.abs(a-c)};b.prototype.tyd=function(a,b,e){if(2>b-a)return 0;e=new _geo.geotoolkit.kd.Line(e.AR,-_geo.geotoolkit.kd.Bb.aHa(e.AR,e.amb));for(var c=0;a<=b;++a){var f=Math.abs(e.distance(this.wsa(a)));c<f&&(c=f)}return c};b.prototype.W9c=function(a,b,e){if(2>b-a)return!0;e=new _geo.geotoolkit.kd.Line(e.AR,-_geo.geotoolkit.kd.Bb.aHa(e.AR,e.amb));
var c=e.project(this.wsa(a)),f=e.project(this.wsa(b)),k=this.depth(a),h=this.depth(b);if(Math.abs(h-k)<_geo.geotoolkit.util.Math.Jc)return!1;for(var f=_geo.geotoolkit.util.na.Cj(c,f)/(h-k),l,n=a+1;n<=b&&(l=e.project(this.wsa(n)))===c;){if(this.jRb(k,f,n,c,l)>this.ujb.getX())return!1;++n}if(n>b)return!0;l=e.project(this.wsa(n));if(this.jRb(k,f,n,c,l)>this.ujb.getX())return!1;a=_geo.geotoolkit.util.Math.sign(l.getX()-c.getX());h=_geo.geotoolkit.util.Math.sign(l.getY()-c.getY());for(n+=1;n<=b;++n){var p=
e.project(this.wsa(n));if(this.jRb(k,f,n,c,p)>this.ujb.getX())return!1;if(p!==l){if(_geo.geotoolkit.util.Math.sign(p.getX()-l.getX())!==a||_geo.geotoolkit.util.Math.sign(p.getY()-l.getY())!==h)return!1;l=p}}return!0};b.prototype.vOb=function(){var b=this.Qja-this.Ipa-1,d,e,c=this.Ipa+1,f=new a,k=new a,h,l;if(1<b)for(;0<b;)d=Math.floor(b/2),e=c+d,this.CIc(this.Ipa,e,k),l=Math.abs(k.CKb)>_geo.geotoolkit.util.Math.Jc?Math.sqrt(Math.abs(k.CKb)):0,l<=this.ujb.getY()&&this.W9c(this.Ipa,e,k)?(f=k,h=l,c=
e,b-=d+1):b=d;else this.CIc(this.Ipa,this.Qja-1,f),h=0,c=this.Qja-1;return new _geo.geotoolkit.kd.gfc(this.Ipa,c,h,new _geo.geotoolkit.kd.Line(f.AR,-_geo.geotoolkit.kd.Bb.aHa(f.AR,f.amb)))};return b}();
_geo.geotoolkit.kd.i_c=function(){function b(b,c,d){_geo.geotoolkit.kd.cJa.call(this);b=_geo.geotoolkit.Ca(b,{filter:!0,trackWidth:0,offset:0});this.Fq=b.trajectory;this.sB=b.filter;this.hx=b.trackWidth;this.ud=b.offset;d&&(d=d.clone());this.Ba=new a(d);this.Ye=d;this.umc=c.joinSegments;this.Ojc=c.approxThreshold;this.A2c=void 0!==c.approxThresholdMd?c.approxThresholdMd:this.Ojc;this.jMb=c.scaleWidth;this.FKb=c.minWidth;this.Oqa=c.maxWidth;this.Rnb=c.widthScaleX;this.KNb=c.widthScaleY;this.XL=-1;
this.sLa=1;this.Mza=[];this.bK=new l;this.Oud=new l;this.dz=new k;this.chd();this.pva();this.dMc()}function a(a){this.Ye=a;this.lf=[];this.UF=new _geo.geotoolkit.kd.Zfc;this.OU=this.bkc=this.iNa=this.hNa=this.zca=this.yca=this.CR=this.BR=1}function g(a,b){return b/(0===a.rj()?Math.abs(a.Pb()):Math.sqrt(a.Pb()*a.Pb()+a.Qi()*a.Qi()))}function d(a,b){return Math.abs(b)>Math.abs(a)?0>b?-Math.atan(a/b):Math.PI-Math.atan(a/b):0>a?-Math.PI/2+Math.atan(b/a):Math.PI/2+Math.atan(b/a)}function e(a,b){return a.xx===
b.xx&&a.yy===b.yy}function c(a){var b=_geo.geotoolkit.util.Math.MI(a.Ab(),5);a=_geo.geotoolkit.util.Math.MI(a.Pb(),5);return{xx:b,yy:a}}var f=16,k=_geo.geotoolkit.util.na,h=_geo.geotoolkit.util.Rect,l=_geo.geotoolkit.util.Ga;_geo.geotoolkit.fa(b,_geo.geotoolkit.kd.cJa);_geo.geotoolkit.da(b,"geotoolkit.deviation.PiecewiseTransformation");b.prototype.crd=function(){this.Ba.bkc=1;var a=this.Ba.lf.length;if(a){var b=this.Ba.lf[0],a=this.Ba.lf[a-1],b=b.nf(),a=a.Cf(),c=[new k(0,b),new k(0,a)],d=[];this.YI(c,
d,this.Ye);for(var e=c=0;e<d.length-1;++e)c+=k.Cj(d[e],d[e+1]);c&&(this.Ba.bkc=Math.max(1,2*_geo.geotoolkit.kd.Bb.IS(.5+c/Math.abs(a-b))))}};b.prototype.yea=function(a){var b=this.Ba.lf.length,c=_geo.geotoolkit.util.Math.findIndex(null,this.Ba.lf,null,null,function(b){b=b.Lm().wa()-a;return Math.abs(b)>_geo.geotoolkit.util.Math.Jc?b:0});0>c?c=~c:++c;c>=b&&(c=b-1);return c};b.prototype.transform=function(a,b){a=b.cb(a);var c=this.yea(a.getY());for(0>c&&(c=0);c<this.Ba.lf.length;++c){var d=this.Ba.lf[c].Lm();
if(a.getY()<=d.wa()&&a.getY()>=d.qa()||d.wa()>a.getY())return this.Ba.lf[c].transform(a)}return 0<this.Ba.lf.length?this.Ba.lf[this.Ba.lf.length-1].transform(a):new k};b.prototype.je=function(a){if(0<=this.XL&&this.XL<this.Ba.lf.length){if(this.Ba.lf[this.XL].contains(a))return this.Ba.lf[this.XL].je(a);if(this.XL<this.Ba.lf.length-1&&this.Ba.lf[this.XL+1].contains(a))return this.Ba.lf[++this.XL].je(a);if(0<this.XL&&this.Ba.lf[this.XL-1].contains(a))return this.Ba.lf[--this.XL].je(a)}for(var b=this.Ba.UF.Dla(),
c=this.Ba.UF.uSa(a.getY()-this.Ye.Th());c<b.length;++c){var d=b[c];if(this.Ba.lf[d.bt.sna].contains(a))return this.XL=d.bt.sna,this.Ba.lf[this.XL].je(a);if(a.getY()<d.bt.YHa)break}return new k(Number.NaN,Number.NaN)};b.prototype.B5=function(a,b,c,d){0!==this.Ba.lf.length&&this.YI([a,b],c,d)};b.prototype.YI=function(a,b,c,d){var e=a.length;if(1<e&&0<this.Ba.lf.length){(d=d&&!_geo.geotoolkit.kd.Bb.aKc(a,e))&&++e;var g,f,h;c?(g=c.Ab(),f=c.Pb(),h=c.ti(),c=c.Th()):(f=g=1,c=h=0);for(var l=new k(Number.MAX_VALUE,
Number.MAX_VALUE),x=new k(a[0].getX()*g+h,a[0].getY()*f+c),A=new k,z=0,C=1,D=0;D<e-1;++D,++C){d&&D===e-2&&(C=0);A.bb(a[C].getX()*g+h,a[C].getY()*f+c);if(0>z||z>=this.Ba.lf.length||!(this.Ba.lf[z].Lm().qa()<=x.getY()&&this.Ba.lf[z].Lm().wa()>=x.getY()))z=this.yea(x.getY());var E,F,K;if(x.getY()<=A.getY())for(K=z;K<this.Ba.lf.length;++K){if(E=this.Ba.lf[K],F=E.Lm(),E.B5(x,A,l,b,this.sB),F.wa()>=A.getY()){z=K;break}}else for(z>=this.Ba.lf.length&&(z=this.Ba.lf.length-1),K=z;0<=K;--K)if(E=this.Ba.lf[K],
F=E.Lm(),E.w7b(x,A,l,b,!1),F.qa()<=A.getY()){z=K;break}x.bb(A.getX(),A.getY())}}};b.prototype.contains=function(a){for(var b=this.Ba.UF.Dla(),c=this.Ba.UF.uSa(a.getY()-this.Ye.Th());c<b.length;++c){var d=b[c];if(d.bt.Y_.contains(a)&&this.Ba.lf[d.bt.sna].contains(a))return!0;if(a.getY()<d.bt.YHa)break}return!1};b.prototype.zDa=function(a){if(1>this.Ba.lf.length)return h.ug;a=this.Ye.ob(a);var b=window.Infinity,c=-window.Infinity,d=this.Ba.UF.Dla(),e,g,f,k;e=this.Ba.UF.Jrd(a.wa()-this.Ye.Th());0<e&&
e--;e!==d.length-1&&a.intersects(d[e].bt.Y_)&&(f=this.Ba.lf[d[e].bt.sna],k=f.Lm(),0<=a.Lda(f.di(),f.st(),this.dz,this.dz)&&(b=k.qa()),0<=a.Lda(f.zr(),f.Sn(),this.dz,this.dz)&&(c=k.wa()));for(e=this.Ba.UF.uSa(a.qa()-this.Ye.Th());e<d.length;++e){g=d[e];f=this.Ba.lf[g.bt.sna];k=f.Lm();if(b>k.qa()||c<k.wa()){if(!a.intersects(g.bt.Y_))continue;if(0<=a.Lda(f.di(),f.st(),this.dz,this.dz)&&0<=a.Lda(f.zr(),f.Sn(),this.dz,this.dz))b>k.qa()&&(b=k.qa()),c<k.wa()&&(c=k.wa());else{var l=new h(a);l.intersect(g.bt.Y_);
this.dz.bb(l.sa(),l.wa());var x=f.je(this.dz);this.dz.bb(l.za(),l.wa());var A=f.je(this.dz);this.dz.bb(l.za(),l.qa());var z=f.je(this.dz);this.dz.bb(l.sa(),l.qa());var C=f.je(this.dz);f=Math.min(x.getX(),A.getX(),z.getX(),C.getX());var D=Math.min(x.getY(),A.getY(),z.getY(),C.getY()),E=Math.max(x.getX(),A.getX(),z.getX(),C.getX()),x=Math.max(x.getY(),A.getY(),z.getY(),C.getY());l.zb(f,D,E,x);l.intersect(k);l.isEmpty()||(b>l.qa()&&(b=l.qa()),c<l.wa()&&(c=l.wa()))}}if(g.bt.YHa>a.wa())break}return b>
c?h.ug:new h(0,b,this.hx,c)};b.prototype.update=function(b){var d=c(b),g=c(this.Ye);if(e(d,g))return this.shift(b),!0;var f=null;this.Mza.some(function(a){return e(a.key,d)?(f=a.value,!0):!1});f?(this.Ba=f,this.Ye=this.Ba.Ye,this.Ba.OU<Number.MAX_VALUE-1&&this.Ba.OU++,this.shift(b)):(this.Ba=new a(b),this.Ye=b,this.dMc(),this.pva());return!0};b.prototype.Tfa=function(a){var b=this.yea(a.getY());for(0>b&&(b=0);b<this.Ba.lf.length;++b){var c=this.Ba.lf[b].Lm();if(a.getY()<=c.wa()&&a.getY()>=c.qa())return this.Ba.lf[b].Tfa(a);
if(c.wa()>a.getY())break}return this.Ba.BR};b.prototype.Vfa=function(a){var b=this.yea(a.getY());for(0>b&&(b=0);b<this.Ba.lf.length;++b){var c=this.Ba.lf[b].Lm();if(a.getY()<=c.wa()&&a.getY()>=c.qa())return this.Ba.lf[b].Vfa(a);if(c.wa()>a.getY())break}return this.Ba.CR};b.prototype.o_=function(){return this.Ba.BR};b.prototype.p_=function(){return this.Ba.CR};b.prototype.lW=function(){return this.Ba.yca};b.prototype.mW=function(){return this.Ba.zca};b.prototype.Tub=function(){return this.Ba.hNa};
b.prototype.Uub=function(){return this.Ba.iNa};b.prototype.J8=function(a,b){if(this.Ba.lf[this.XL]&&this.Ba.lf[this.XL].contains(a))return this.Ba.lf[this.XL].J8(a,b);for(var c=this.Ba.UF.Dla(),d=this.Ba.UF.uSa(a.getY()-this.Ye.Th());d<c.length;++d){var e=c[d];if(e.bt.Y_.contains(a))return this.XL=e.bt.sna,this.Ba.lf[this.XL].J8(a,b);if(a.getY()<e.bt.YHa)break}return null};b.prototype.z1b=function(a){if(!this.jMb)return 1;a=Math.sqrt(this.sLa*(a.Ab()/this.Rnb)*(a.Ab()/this.Rnb)+(1-this.sLa)*(a.Pb()/
this.KNb)*(a.Pb()/this.KNb));this.hx*a<this.FKb&&(a=this.FKb/this.hx);this.hx*a>this.Oqa&&(a=this.Oqa/this.hx);return a};b.prototype.Cvd=function(){this.Mza.forEach(function(a){delete a.value})};b.prototype.pva=function(){var a=!1;this.Ba.BR=0;this.Ba.CR=0;this.Ba.yca=0;this.Ba.zca=0;this.Ba.hNa=1;this.Ba.iNa=1;for(var b=[],c=[],e=[],f=this.z1b(this.Ye),m=this.Fq.Sed(this.Ye,this.Ojc,this.A2c),u=this.Ye.Vd(),v,w,x,A,z,C=[],D,E,F=new l,K;!m.end();)if(null==v&&(z=m.object(),v=0===b.length?z.D8c():w,
x=0===b.length?z.line().project(this.Ye.dg(this.Fq.getX(v),this.Fq.getY(v))):A,w=z.VRb(),A=z.line().project(this.Ye.dg(this.Fq.getX(w),this.Fq.getY(w))),z=u.cb(x),E=x.getY()-A.getY(),D=x.getX()-A.getX(),D=d(D,E),l.kj(z.getX(),z.getY(),this.bK),l.multiply(this.Ye,this.bK,F),this.Ye.cb(z,this.dz),l.dn(D,this.dz.getX(),this.dz.getY(),this.bK),l.multiply(this.bK,F,F),D=0===F.Qi()?Math.abs(F.Ab()):Math.sqrt(F.Ab()*F.Ab()+F.rj()*F.rj()),E=0===F.rj()?Math.abs(F.Pb()):Math.sqrt(F.Pb()*F.Pb()+F.Qi()*F.Qi()),
0>this.Ye.Pb()&&(E=-E),0>this.Ye.Ab()&&(D=-D),x=k.Cj(x,A),z=this.Fq.wc(w)-this.Fq.wc(v),E=Math.abs(z)>_geo.geotoolkit.util.Math.Jc?1/E*(x/z):1,this.bK.kc(f/D,0,0,E,0,0),l.multiply(F,this.bK,F),this.bK.kc(1,0,0,1,-this.hx/2+this.ud,-this.Fq.wc(v)),l.multiply(F,this.bK,F),K=new h(0,this.Fq.wc(v),this.hx,this.Fq.wc(w)),v=new _geo.geotoolkit.kd.lfb(F,K,!1),v.update()),this.umc){var H=0;0===b.length&&(b.push(x),c.push(this.Fq.wc(0)+z));if(0<C.length){var G=C[C.length-1];e[e.length-1]-=G.j_();var J=_geo.geotoolkit.kd.yEb.uad(G,
v);"number"===typeof J&&(H=J,J=null);e[e.length-1]+=G.j_();0===H&&(b.push(b[b.length-1]+x),c.push(c[c.length-1]+z));if(J)C.push(J),e.push(J.j_()+e[e.length-1]);else if(-1===H)1<b.length?(b[b.length-2]=b[b.length-1],c[c.length-2]=c[c.length-1],b.pop(),c.pop(),e.pop(),C.pop(),C[C.length-1]instanceof _geo.geotoolkit.kd.yEb&&(e.pop(),C.pop())):(b[b.length-1]+=x,c[c.length-1]+=z,e[e.length-1]-=G.j_(),H=G.Lm().clone().union(v.Lm()),v.$ab(H),v.update(),e[e.length-1]+=v.j_(),C.pop(),C.push(v),v=null,H=0);
else if(1===H)b[b.length-1]+=x,c[c.length-1]+=z,e[e.length-1]+=v.j_(),v=null;else if(0===H){var I=0;D=0;J=G.Lm();D=G.transform(J.Sn());E=G.transform(this.dz.bb(J.Pc(),J.wa()));var O=v.transform(K.st()),I=2*k.Cj(D,E);D=_geo.geotoolkit.kd.Bb.E9c(D,E,O);D=Math.abs(I/2*Math.sin(D));D>_geo.geotoolkit.util.Math.Jc?(I=g(v.Ra(),D),D=g(G.Ra(),D),e[e.length-1]-=G.j_(),G.aPc(J.wa()-D),v.gPc(K.qa()+I),e[e.length-1]+=G.j_(),J=G.Lm(),K=v.Lm(),J=new _geo.geotoolkit.kd.lfb(v.Ra(),new h(0,J.wa(),this.hx,K.qa()),!0),
J.ypd(G.Ra()),J.update(),C.push(J),e.push(J.j_()+e[e.length-1])):(G.Upb(),v.Upb())}}else v.Upb();v&&0===H&&(C.push(v),e.push(0<e.length?v.j_()+e[e.length-1]:v.j_()),v=null);-1!==H&&m.next()}else a=this.Yrc(v,a),m.next();if(this.umc&&0<C.length)for(C[C.length-1]instanceof _geo.geotoolkit.kd.lfb&&C[C.length-1].Upb(),m=b[b.length-1]/e[e.length-1]||1,w=0,K=v=null,H=0;H<C.length;++H)if(G=C[H],G instanceof _geo.geotoolkit.kd.lfb){if(0<G.ckd()){for(x=0===H?0:e[H-1]*m;b[w]<x&&w<b.length-1;)w++;A=0===w?0:
b[w-1];A=(x-A)/(b[w]-A);x=0===w?this.Fq.wc(0):c[w-1];J=x*(1-A)+c[w]*A;for(x=e[H]*m;b[w]<x&&w<b.length-1;)w++;A=0===w?0:b[w-1];A=(x-A)/(b[w]-A);x=0===w?this.Fq.wc(0):c[w-1];I=x*(1-A)+c[w]*A;x=G.lqd();A=G.Hcd();z=u.cb(x);D=x.getX()-A.getX();E=x.getY()-A.getY();D=d(D,E);l.kj(z.getX(),z.getY(),this.bK);l.multiply(this.Ye,this.bK,F);this.Ye.cb(z,this.dz);l.dn(D,this.dz.getX(),this.dz.getY(),this.bK);l.multiply(this.bK,F,F);D=0===F.rf?Math.abs(F.Of):Math.sqrt(F.Of*F.Of+F.Mg*F.Mg);E=0===F.Mg?Math.abs(F.tg):
Math.sqrt(F.tg*F.tg+F.rf*F.rf);0>this.Ye.tg&&(E=-E);0>this.Ye.Of&&(D=-D);x=k.Cj(x,A);z=I-J;E=Math.abs(z)>_geo.geotoolkit.util.Math.Jc?1/E*(x/z):1;l.km(f/D,E,this.bK);l.multiply(F,this.bK,F);l.kj(-this.hx/2,-J,this.bK);l.multiply(F,this.bK,F);G.kc(F);G.$ab(new h(0,J,this.hx,I));G.update();v&&K&&(v.$ab(new h(K.Lm().sa(),K.Cf(),K.Lm().za(),G.nf())),this.pob(v),v=null);K=G}a=this.Yrc(G,a)}else v=G instanceof _geo.geotoolkit.kd.yEb?G:null;1<this.Ba.lf.length&&(this.Ba.hNa=Math.pow(this.Ba.hNa,1/this.Ba.lf.length),
this.Ba.iNa=Math.pow(this.Ba.iNa,1/this.Ba.lf.length));0===this.Ba.BR&&(this.Ba.BR=1);0===this.Ba.CR&&(this.Ba.CR=1);0===this.Ba.yca&&(this.Ba.yca=1);0===this.Ba.zca&&(this.Ba.zca=1);a=window.Infinity;b=this.Ba.UF.Dla();for(c=b.length-1;0<=c;--c)e=b[c],e.bt.YHa=a,a=Math.min(a,e.bt.Y_.qa());this.crd()};b.prototype.Yrc=function(a,b){this.pob(a);var c=a.o_(),d=a.p_();this.Ba.hNa*=c;this.Ba.iNa*=d;b?(this.Ba.BR=Math.max(c,this.Ba.BR),this.Ba.CR=Math.max(d,this.Ba.CR),this.Ba.yca=Math.min(c,this.Ba.yca),
this.Ba.zca=Math.min(d,this.Ba.zca)):(this.Ba.BR=c,this.Ba.CR=d,this.Ba.yca=c,this.Ba.zca=d,b=!0);return b};b.prototype.pob=function(a){var b=a.di().getX(),c=a.di().getY(),d=a.zr().getX(),e=a.zr().getY(),g=a.st().getX(),f=a.st().getY(),k=a.Sn().getX(),l=a.Sn().getY(),x=Math.min(b,d,g,k),A=Math.min(c,e,f,l),b=Math.max(b,d,g,k),c=Math.max(c,e,f,l),A=new h(x,A,b,c),x=new _geo.geotoolkit.kd.bt(this.Ba.lf.length,A),A=A.wa()-this.Ye.Th();this.Ba.UF.gs(new _geo.geotoolkit.kd.Ahc(A,x));this.Ba.lf.push(a)};
b.prototype.chd=function(){for(var a=0,b=0,c=0,e,g,f=1;f<this.Fq.count();++f)e=this.Rnb*(this.Fq.getX(c)-this.Fq.getX(f)),g=this.KNb*(this.Fq.getY(c)-this.Fq.getY(f)),1<f&&f<this.Fq.count()-1&&.5>Math.abs(e)&&.5>Math.abs(g)?f++:(b+=Math.abs(d(e,g)),a++,c=f);0<a&&(b/=a);this.sLa=Math.sin(b);this.sLa*=this.sLa};b.prototype.dMc=function(){if(this.Mza.length>=f){for(var a=window.Infinity,b=0,d=0;d<this.Mza.length;++d){var e=this.Mza[d];if(a>e.value.OU&&(b=d,a=e.value.OU,1===a))break}this.Mza.splice(b,
1)}this.Mza.push({key:c(this.Ye),value:this.Ba})};b.prototype.shift=function(a){var b=a.ti()-this.Ye.ti(),c=a.Th()-this.Ye.Th();if(Math.abs(b)>_geo.geotoolkit.util.Math.Jc||Math.abs(c)>_geo.geotoolkit.util.Math.Jc){this.dz.bb(b,c);l.kj(b,c,this.bK);for(var b=null,d=0;d<this.Ba.lf.length;++d)this.Ba.lf[d].offset(this.dz),this.Ba.lf[d].nmd(b),b=this.Ba.lf[d];b=this.Ba.UF.Dla();for(d=0;d<b.length;++d){var e=b[d];e.bt.YHa+=c;this.bK.ob(e.bt.Y_,e.bt.Y_)}}this.Ye=this.Ba.Ye=a};b.prototype.VSb=function(){return this.Ye};
return b}();
_geo.geotoolkit.kd.zEb=function(){function b(a){_geo.geotoolkit.kd.bLa.call(this);this.la=_geo.geotoolkit.Ca(a,{joinSegments:!0,scaleWidth:!1,minWidth:-window.Infinity,maxWidth:window.Infinity,widthScaleX:1,widthScaleY:1,approxThreshold:.5});this.la.approxThresholdMd=void 0!==this.la.approxThresholdMd?this.la.approxThresholdMd:this.la.approxThreshold}_geo.geotoolkit.fa(b,_geo.geotoolkit.kd.bLa);_geo.geotoolkit.da(b,"geotoolkit.deviation.PiecewiseTransformer");b.prototype.jb=function(){return _geo.geotoolkit.Ca(this.la,{})};
b.prototype.setOptions=function(a){_geo.geotoolkit.Ca(a,this.la);return this};b.prototype.create=function(a,b){return new _geo.geotoolkit.kd.i_c(a,this.la,b)};return b}();
_geo.geotoolkit.kd.rhb=function(){function b(b,d,e,c,f,k){if(!b||1>b.length||!d||1>d.length||b.length!==d.length)throw Error();var h;if(!e)for(e=[0],h=1;h<b.length;h++){var l=b[h]-b[h-1],n=d[h]-d[h-1];e.push(e[h-1]+Math.sqrt(l*l+n*n))}this._x=[b[0]];this._y=[d[0]];this.fm=[e[0]];for(h=1;h<e.length;h++)e[h]-e[h-1]<a||(this._x.push(b[h]),this._y.push(d[h]),this.fm.push(e[h]));this.vp=void 0!==c?c:Math.min.apply(null,e);this.Op=void 0!==f?f:Math.max.apply(null,e);this.Ntd=void 0!==k?k:!0;this.Ao=Math.min.apply(null,
b);this.Cs=Math.max.apply(null,b);this.Bo=Math.min.apply(null,d);this.Ds=Math.max.apply(null,d)}var a=.001;_geo.geotoolkit.da(b,"geotoolkit.deviation.Trajectory2d");b.prototype.getX=function(a){return this._x[a]};b.prototype.getY=function(a){return this._y[a]};b.prototype.wc=function(a){return this.fm[a]};b.prototype.count=function(){return this._x?this._x.length:0};b.prototype.$i=function(){return this.vp};b.prototype.Si=function(){return this.Op};b.prototype.Sed=function(a,b,e){return new _geo.geotoolkit.kd.h_c(this,
a,new _geo.geotoolkit.util.na(e,b))};b.Fad=function(a,d,e,c,f,k,h){if(!a||!d||a.length!==d.length)return null;for(e=0;e<a.length-1;++e)if(a[e+1]<a[e])return null;var l=new _geo.geotoolkit.util.na,n=new _geo.geotoolkit.util.na,p=new _geo.geotoolkit.util.na;k=void 0!==k?k:!0;h=void 0!==h?h:!0;var r=a.length,t=[],q=[],m=[];f=f||0;var u=a[0],v,w,x,A,z=0;for(e=0;e<r;e++){var C=c?d[e]:-d[e];if(0===e)t[0]=f,q[0]=u,m[0]=a[e],x=C,w=a[e],v=a[e];else{A=a[e]-m[z];f+=A*Math.sin(Math.PI*x/180);u+=A*Math.cos(Math.PI*
x/180);if(k){if(0<=z){l.bb(t[z-1],q[z-1]);n.bb(t[z],q[z]);p.bb(f,u);x=_geo.geotoolkit.util.na.Cj(n,p);var D=x<_geo.geotoolkit.util.Math.Jc,E=0<z&&!D&&_geo.geotoolkit.kd.Bb.uGc(l,n,p);D||(E?(D=_geo.geotoolkit.util.na.Cj(l,n),(A=Math.abs(x/D-A/(m[z]-m[z-1]))<_geo.geotoolkit.util.Math.Jc)||++z):++z,t[z]=f,q[z]=u,m[z]=a[e])}}else++z,t[z]=f,q[z]=u,m[z]=a[e];x=C;m[z]>w&&(w=m[z]);m[z]<v&&(v=m[z])}}return 0<z?new b(t,q,m,v,w,h):null};b.prototype.KV=function(){return this.Ao};b.prototype.LV=function(){return this.Bo};
b.prototype.OZ=function(){return this.Cs};b.prototype.PZ=function(){return this.Ds};return b}();
_geo.geotoolkit.scene.bha=function(){function b(){_geo.geotoolkit.scene.CompositeNode.call(this);this.Rb=this.JL=this.gE=null;this.ira=new _geo.geotoolkit.util.na}_geo.geotoolkit.fa(b,_geo.geotoolkit.scene.CompositeNode);_geo.geotoolkit.da(b,"geotoolkit.scene.DeviatedCompositeNode");b.cqd=!1;b.$={MBb:"onDeviationChanged"};b.prototype.addListener=function(a,b){this.kb(a,b);return this};b.prototype.removeListener=function(a,b){this.hb(a,b);return this};b.prototype.i_b=function(){this.Ja(_geo.geotoolkit.scene.bha.$.MBb,
this)};b.prototype.H_=function(a){null==a?this.gE=null:(this.gE||(this.gE=new _geo.geotoolkit.renderer.noa),this.gE.H_(a));this.i_b();this.Pa();this.ma();return this};b.prototype.IM=function(){return this.gE?this.gE.IM():null};b.prototype.xa=function(){var a=this.IM();if(!a)return null;var b=a.trackWidth,a=a.trajectory;return new _geo.geotoolkit.util.Rect(0,a.$i(),b,a.Si())};b.prototype.ga=function(){return this.Rb?this.Rb.Mi():this.Itb()};b.prototype.Ea=function(a){if(null!=this.Rb&&this.Rb.Pj(a))return this;
this.Ri();this.Rb!==a&&(this.Rb=null!=a?new _geo.geotoolkit.util.Rect(a):a);this.Pa();this.Ri();return this};b.prototype.Itb=function(){var a=this.IM();if(!a)return null;a=a.trajectory;return new _geo.geotoolkit.util.Rect(a.KV(),a.LV(),a.OZ(),a.PZ())};b.prototype.Pa=function(a,b){_geo.geotoolkit.scene.CompositeNode.prototype.Pa.call(this,a,b);this.JL=null;return this};b.prototype.ee=function(){if(null!=this.JL)return this.JL;var a=this.ga(),b=this.Itb();null==a||a.isEmpty()||null==b||b.isEmpty()||
(this.JL=_geo.geotoolkit.util.Ga.hf(b,a,!1,!1,!1));return this.JL};b.prototype.nSc=function(a){var b=this.gE,d=[];a=[a.di(),new _geo.geotoolkit.util.na(a.za(),a.qa()),a.Sn(),new _geo.geotoolkit.util.na(a.sa(),a.wa())];b.gi.YI(a,d,b.Ye,!0);return _geo.geotoolkit.util.Ec.getBoundingBox(d)};b.prototype.Ri=function(a,b){if(!this.gE||!this.gE.Te)return this;var d=this.getParent();if(d){var e;a?(e=this.nSc(a),e=this.gE.gi.Ye.qe(e)):e=d.xa();d.ma(e,b)}if(this.Ru)for(d=0;d<this.Ru.length;++d)if(e=this.Ru[d])if("function"==
typeof e)e.call(this,a,b);else e.onInvalidate(a,b);return this};b.prototype.ie=function(a){if(!this.ib())return!1;var b=this.ga();if(null!=b){var d=this.Yb();null!=d&&(b=d.ob(b));b=a.Ra().ob(b);d=this.IM();null!=d&&null!=d.trackWidth&&b.fe(d.trackWidth);if(!a.$e().intersects(b))return!1}return!0};b.prototype.render=function(a){if(this.IM()){var g=null!=this.mb()?a.qc(this.mb()):a;g.save();this.gE.update(g);var d=g.$e(),e=g.Ra().qe(d),e=this.gE.PPa(e);if(e.isEmpty())g.restore();else{if(this.gE.IM().clip){var c=
this.nSc(e),c=c.intersect(d);g.Ni(c)}this.gE.yab(e);for(d=this.Ji();d.Xf();)e=d.next(),this.gE.filter(e)&&(a.Gd()&&this.gE.El(e),e.render(this.gE));g.restore();b.cqd&&this.gE.tcd(new _geo.geotoolkit.attributes.Aa("red",2))}}else _geo.geotoolkit.scene.CompositeNode.prototype.render.call(this,a)};b.prototype.kxc=function(a,b){if(null==this.gE)return null;this.gE.Kzb(this.Ya());var d=this.gE.PPa(a);if(d.isEmpty())return null;b?b.ni(d.qa(),d.wa()):b=new _geo.geotoolkit.util.Range(d.qa(),d.wa());return b};
return b}();
_geo.geotoolkit.renderer.noa=function(){function b(a){_geo.geotoolkit.renderer.UT.call(this);this.Ye=null!=a?a:new _geo.geotoolkit.util.Ga;this.nnb=null;this.la={};this.la.trajectory=null;this.la.transformer=new _geo.geotoolkit.kd.zEb;this.la.trackWidth=100;this.la.offset=0;this.la.clip=!0;this.gi=this.Te=null;this.Ba=[];this.eK=new _geo.geotoolkit.util.Ga;this.ira=new _geo.geotoolkit.util.na;this.Rba=this.Qba=window.NaN;this.vMa=this.ul=null;this.Xh=[0,0,0,0];this.XBa=[];this.L1=this.eq=this.CH=
null}var a=function(){function a(b,c){this.bh=b;this.$h=c;this.Rb=new _geo.geotoolkit.util.Rect(0,0,this.bh,this.$h);this.Ujb=new _geo.geotoolkit.renderer.canvas.Mr(this.bh,this.$h,!0);this.$X=this.Ujb.vM(this.bh,this.$h);this.sjb=!0;var d=new _geo.geotoolkit.util.hX;this.WAa=d.isIOS||d.isSafari}a.prototype.aa=function(){return this.bh};a.prototype.ba=function(){return this.$h};a.prototype.clear=function(){if(null==this.$X)return this;for(var a=this.$X.getData(),b=4*this.$X.aa()*this.$X.ba(),c=0;c<
b;c++)a[c]=0;this.WAa&&this.Ujb.clear();return this};a.prototype.pr=function(){!1===this.sjb&&this.clear();this.sjb=!0;return this};a.prototype.Lq=function(){this.Ujb.vN(this.$X,0,0)};a.prototype.$xb=function(a,b,c){this.sjb=!1;var d=this.$X.getData();a=4*(b*this.bh+a);d[a+0]=c[0];d[a+1]=c[1];d[a+2]=c[2];d[a+3]=c[3]};a.prototype.lp=function(a,b){this.Rb.setX(a).setY(b);return this};a.prototype.ga=function(){return this.Rb};a.prototype.render=function(a,b,c){if(!0===this.sjb)return this;c.drawImage(this.Ujb,
0,0,this.bh,this.$h,a,b,this.bh,this.$h);return this};return a}(),g=function(){function a(b,c){this.TH=b;this.Rb=c;this.Vf=Math.ceil(c.aa()/b.aa());this.oj=Math.ceil(c.ba()/b.ba())}a.prototype.T7a=function(){return this.oj};a.prototype.t6a=function(){return this.Vf};a.prototype.lgd=function(a,b){var c=this.Rb.sa()+a*this.TH.aa(),d=this.Rb.qa()+b*this.TH.ba();return this.TH.lp(c,d)};return a}(),d=_geo.geotoolkit.util.na,e=new d(0,0),c=new d(0,0),f=new d(0,0),k=new d(0,0);_geo.geotoolkit.fa(b,_geo.geotoolkit.renderer.UT);
b.prototype.Is=function(){if(!this.Te)throw Error("Parent rendering context is not defined");};b.prototype.H_=function(a){_geo.geotoolkit.Ca(a,this.la);this.gi&&this.la.transformer&&(a=this.eK,"function"==typeof this.gi.VSb&&(a=this.gi.VSb()),this.gi=this.la.transformer.create(this.la,a))};b.prototype.IM=function(){return this.la};b.prototype.Urb=function(){return this.gi?_geo.geotoolkit.Ca(this.gi.KWb(),{}):{}};b.prototype.gDc=function(){return this.Te};b.prototype.update=function(a){this.Kzb(a.Ra());
this.Te=a;this.setFilters(this.Te?this.Te.getFilters():null)};b.prototype.Kzb=function(a){a&&(this.gi?this.gi.update(a):this.gi=this.la.transformer.create(this.la,a));this.Ye.swa()};b.prototype.qc=function(a){a=_geo.geotoolkit.util.Ga.multiply(this.Ye,a);a=new b(a);a.H_(this.IM());a.setFilters(this.getFilters());a.yab(this.CH);this.Te.El(this.L1);a.gi=this.gi;a.Te=this.Te;return a};b.prototype.Ra=function(){return this.Ye};b.prototype.kc=function(a){this.Ye=a;this.eq=this.nnb=null;return this};b.prototype.yr=
function(){null==this.nnb&&(this.nnb=this.Ye.Vd());return this.nnb};b.prototype.mz=function(){this.Is();return this.Te.mz()};b.prototype.cb=function(a){return this.gi.transform(a,this.Ye)};b.prototype.B5=function(a,b,c){c||(c=[]);this.gi.YI([a,b],c,this.Ye);return c};b.prototype.zc=function(a,b,d,g){a instanceof _geo.geotoolkit.util.Rect?(e.bb(a.sa(),a.qa()),c.bb(a.sa()+a.aa(),a.qa()+a.ba())):(e.bb(a,b),c.bb(a+d,b+g));a=[e.getX(),c.getX(),c.getX(),e.getX(),e.getX()];b=[e.getY(),e.getY(),c.getY(),
c.getY(),e.getY()];this.Ik(a,b);return this};b.Abc=new a(256,256);b.prototype.mwb=function(a,b,c,d,f,k,h,l,p,n){if(h===p||l===n)return this;var C=null;"function"===typeof this.ul.pI&&(null!=this.vMa&&(c=this.vMa.sa(),d=this.vMa.qa(),f=this.vMa.za(),k=this.vMa.wa()),C=this.ul.pI(c,d,f,k));if(!C)return this;c=1;d=[];f=[];if(1!==c)for(h*=c,l*=c,p*=c,n*=c,k=0;k<a.length;++k)d.push(a[k]*c),f.push(b[k]*c);else d=a,f=b;h=Math.floor(h);l=Math.floor(l);p=Math.ceil(p);n=Math.ceil(n);if(0>h+(p-h+1)||0>l+(n-
l+1))return this;h=new _geo.geotoolkit.util.Rect(h,l,p,n);(b=this.Te.$e().clone())&&1!==c&&b.zb(b.sa()*c,b.qa()*c,b.za()*c,b.wa()*c);if(!1===h.intersects(b))return this;h.intersect(b);if(h.isEmpty())return this;h.zb(Math.floor(h.sa()),Math.floor(h.qa()),Math.ceil(h.za()),Math.ceil(h.wa()));a=h.ba();n=this.Ye.Vd();if(d[0]!==d[d.length-1]||f[0]!==f[f.length-1])d.push(d[0]),f.push(f[0]);k=[{}];var D=new g(_geo.geotoolkit.renderer.noa.Abc,h),E=_geo.geotoolkit.renderer.noa.Abc.aa(),F=this.Te.Ra();this.Te.kc(_geo.geotoolkit.util.Ga.N0);
for(var K=0;K<D.T7a();K++)for(var H=0;H<D.t6a();H++){var G=D.lgd(H,K),J=G.ga();if(null==b||!1!==b.intersects(G.ga())){G.pr();h=G.ga().sa();l=G.ga().qa();p=G.ga().za();G.ga().wa();for(var I=0;I<a;++I){var O=l+I;if(!b||!(O<b.qa()||O>b.wa()))for(var M=_geo.geotoolkit.kd.Bb.Gdd(d,f,O,k),L=0;L<M.length;++L){var N=M[L];if(!(1>N.fh-N.from)){var T=Math.floor(N.from);T<h&&(T=h);var Q=Math.ceil(N.fh);Q>p&&(Q=p);for(var P=Math.ceil(N.from)-N.from,N=N.fh-Math.floor(N.fh),S=T;S<=Q;++S){var U=S-h;if(!(0>U||U>=
J.aa()||0>I||I>=J.ba()||b&&!b.contains(S,O))){e.bb(S/c,O/c);var R=this.gi.je(e);(0,window.isNaN)(R.getX())||(0,window.isNaN)(R.getY())||(n.cb(R,R),C.An(R.getX(),R.getY(),this.Xh),S===T&&0!==U?this.Xh[3]=Math.round(P*this.Xh[3]):S===Q&&U!==E&&(this.Xh[3]=Math.round(N*this.Xh[3])),G.$xb(U,I,this.Xh))}}}}}G.Lq();G.render(h/c,l/c,this.Te)}}this.Te.kc(F);return this};b.prototype.hcd=function(){var a=_geo.geotoolkit.scene.shapes.Fn.U8(_geo.geotoolkit.util.Rect.mB,this.L1.tw()),b=a.getX(),a=a.getY(),c=this.gi.transform(new d(b,
a),this.Ye),b=c.getX(),a=c.getY(),e=this.gi.je(c);this.ira.bb(0,e.getY());c=this.gi.transform(this.ira,this.eK);this.ira.bb(this.la.trackWidth,e.getY());var e=this.gi.transform(this.ira,this.eK),g=Math.atan2(e.getY()-c.getY(),e.getX()-c.getX()),c=0>this.Ye.Ab(),e=0>this.Ye.Pb(),g=_geo.geotoolkit.util.Ga.dn(g,0,0),a=_geo.geotoolkit.util.Ga.kj(b,a),b=new _geo.geotoolkit.util.Ga;c||e?(b.scale(c?-1:1,e?-1:1),_geo.geotoolkit.util.Ga.multiply(g,b,b),_geo.geotoolkit.util.Ga.multiply(a,b,b)):_geo.geotoolkit.util.Ga.multiply(a,
g,b);a=this.Te.Ra();this.Te.kc(b);b=this.L1.pj();this.L1.ke(!1);this.L1.yc(0,0);this.L1.render(this.Te);this.L1.yc(b);this.L1.ke(!0);this.Te.kc(a)};b.prototype.Ik=function(a,b,c,e){this.Is();if(!this.la.trajectory)return this;if(this.L1&&this.L1 instanceof _geo.geotoolkit.scene.shapes.Fn&&this.L1.ZB())return this.hcd(),this;var g,f,h=Math.min(a.length,b.length),k=[];e=c=Number.POSITIVE_INFINITY;var l=Number.NEGATIVE_INFINITY,p=Number.NEGATIVE_INFINITY,n;for(n=0;n<h;++n)g=a[n],f=b[n],g<c&&(c=g),f<
e&&(e=f),g>l&&(l=g),f>p&&(p=f),k.push(new d(a[n],b[n]));c=Math.floor(c);e=Math.floor(e);l=Math.ceil(l);p=Math.ceil(p);this.Ba=[];this.gi.YI(k,this.Ba,this.Ye,!0);a=[];b=[];var k=h=Number.POSITIVE_INFINITY,D=Number.NEGATIVE_INFINITY,E=Number.NEGATIVE_INFINITY;for(n=0;n<this.Ba.length;++n)g=this.Ba[n].getX(),f=this.Ba[n].getY(),g<h&&(h=g),f<k&&(k=f),g>D&&(D=g),f>E&&(E=f),a.push(g),b.push(f);if(a[a.length-1]!==a[0]||b[b.length-1]!==b[0])a.push(a[0]),b.push(b[0]);g=0;f=a.length-1;this.Ba=[];n=this.Te.Ra();
this.Te.kc(this.eK);this.ul&&this.mwb(a,b,c,e,l,p,h,k,D,E);this.Te.Ik(a,b,g,f);this.Te.kc(n);return this};b.prototype.xn=function(a,b,c,e){this.Is();if(!this.la.trajectory)return this;void 0===c&&(c=0,e=Math.min(a.length,b.length)-1);if(e<=c)return this;for(var g=[];c<=e;++c)g.push(new d(a[c],b[c]));this.Ba=[];this.gi.YI(g,this.Ba,this.Ye,!1);a=[];b=[];for(c=0;c<this.Ba.length;++c)a.push(this.Ba[c].getX()),b.push(this.Ba[c].getY());c=0;e=a.length-1;this.Ba=[];g=this.Te.Ra();this.Te.kc(this.eK);this.Te.xn(a,
b,c,e);this.Te.kc(g);return this};b.prototype.tcd=function(a){var b=this.IM().yAd;this.Te.ua(a);this.Te.xn(b._x,b._y,0,b._x.length-1)};b.prototype.Pd=function(a,b,d,g){this.Is();if(!this.la.trajectory)return this;e.bb(a,b);c.bb(d,g);this.Ba=[];this.gi.YI([e,c],this.Ba,this.Ye);a=[];b=[];for(d=0;d<this.Ba.length;++d)a.push(this.Ba[d].getX()),b.push(this.Ba[d].getY());d=0;g=a.length-1;this.N7b([e,c],this.Ba);this.Ba=[];var f=this.Te.Ra();this.Te.kc(this.eK);this.Te.xn(a,b,d,g);this.Te.kc(f);return this};
b.prototype.eob=function(a,b,d,g){e.bb(a.Yea(),a.afa());c.bb(a.Zea(),a.bfa());f.bb(a.$ea(),a.cfa());k.bb(a.C9(),a.D9());a=_geo.geotoolkit.util.Math.QCa(e,c,f,k);this.Ba=[];this.gi.YI(a,this.Ba,this.Ye,!1);for(a=0;a<this.Ba.length;++a){var h=this.Ba[a].getX(),l=this.Ba[a].getY();h<g.QD&&(g.QD=h);l<g.yMin&&(g.yMin=l);h>g.PD&&(g.PD=h);l>g.yMax&&(g.yMax=l);b.push(h);d.push(l)}};b.prototype.po=function(a,b,c,d){this.Is();if(!this.la.trajectory)return this;var e=a,g=b,f=a+c,h=b+d;d=_geo.geotoolkit.renderer.Bb.ata(a+
c/2,b+d/2,c,d);a=[];b=[];c={QD:Number.POSITIVE_INFINITY,yMin:Number.POSITIVE_INFINITY,PD:Number.NEGATIVE_INFINITY,yMax:Number.NEGATIVE_INFINITY};for(var k=0;k<d.length;++k)this.eob(d[k],a,b,c);d=this.Te.Ra();this.Te.kc(this.eK);this.ul&&this.mwb(a,b,e,g,f,h,c.QD,c.yMin,c.PD,c.yMax);this.Te.Ik(a,b);this.Te.kc(d);return this};b.prototype.iq=function(a,b,c,e,g,h,k,l,p){this.Is();if(!this.la.trajectory)return this;if(h-g>=2*Math.PI)return this.po(a,b,c,e),this;var n=a,C=b,D=a+c,E=b+e;a+=c/2;b+=e/2;k=
[];var F=[];if(!l){var K=this.gi.transform(new d(a,b),this.Ye);k.push(K.getX());F.push(K.getY())}a=_geo.geotoolkit.renderer.Bb.ata(a,b,c,e,g,h);if(1>a.length)return this;b={QD:Number.POSITIVE_INFINITY,yMin:Number.POSITIVE_INFINITY,PD:Number.NEGATIVE_INFINITY,yMax:Number.NEGATIVE_INFINITY};for(c=0;c<a.length;++c)this.eob(a[c],k,F,b);a=this.Te.Ra();this.Te.kc(this.eK);if(l)if(p)for(l=0;l<k.length;++l)p=f.bb(k[l],F[l]),this.Te.lineTo(p.getX(),p.getY());else this.Te.xn(k,F);else this.Te.Ik(k,F);this.Te.kc(a);
if(this.ul){this.twb();this.xJ={QD:n,yMin:C,PD:D,yMax:E};for(n=0;n<k.length;++n){C=Math.round(k[n]);D=Math.round(F[n]);E=this.uda.length;if(0===E||this.uda[E-1]!==C&&this.Ura[E-1]!==D)this.uda.push(C),this.Ura.push(D);k[n]<this.Xz.QD&&(this.Xz.QD=k[n]);F[n]<this.Xz.yMin&&(this.Xz.yMin=F[n]);k[n]>this.Xz.PD&&(this.Xz.PD=k[n]);F[n]>this.Xz.yMax&&(this.Xz.yMax=F[n])}this.Te.kc(this.eK);this.mwb(this.uda,this.Ura,this.xJ.QD,this.xJ.yMin,this.xJ.PD,this.xJ.yMax,this.Xz.QD,this.Xz.yMin,this.Xz.PD,this.Xz.yMax);
this.twb();this.Te.kc(a)}return this};b.prototype.jx=function(a,b,c,d,e,g){this.Is();if(!this.la.trajectory)return this;var f=g-e>=2*Math.PI;f&&(e=0,g=2*Math.PI);c=_geo.geotoolkit.renderer.Bb.ata(a,b,2*c,2*c,e,g);a=_geo.geotoolkit.renderer.Bb.ata(a,b,2*d,2*d,e,g,!0);if(f){this.beginPath();b=c[0];this.moveTo(b.Yea(),b.afa());for(f=0;f<c.length;++f)b=c[f],this.bezierCurveTo(b.Zea(),b.bfa(),b.$ea(),b.cfa(),b.C9(),b.D9());b=a[a.length-1];this.moveTo(b.C9(),b.D9());for(f=a.length-1;0<=f;--f)b=a[f],this.bezierCurveTo(b.$ea(),
b.cfa(),b.Zea(),b.bfa(),b.Yea(),b.afa());this.closePath();this.Te.si();this.Te.stroke()}else{b=[];d=[];e={QD:Number.POSITIVE_INFINITY,yMin:Number.POSITIVE_INFINITY,PD:Number.NEGATIVE_INFINITY,yMax:Number.NEGATIVE_INFINITY};for(f=0;f<c.length;++f)this.eob(c[f],b,d,e);for(f=0;f<a.length;++f)this.eob(a[f],b,d,e);c=this.Te.Ra();this.Te.kc(this.eK);this.Te.Ik(b,d);this.Te.kc(c)}return this};var h=new _geo.geotoolkit.util.Fc([],[]),l=new _geo.geotoolkit.util.Fc([],[]),n=_geo.geotoolkit.dD.Rt(100,100),p=
!1;b.prototype.drawImage=function(a,b,g,m,u,v,w,x,A){"function"===typeof a.Kk&&(a=a.Kk());void 0===m&&(m=a.width,u=a.height,v=b,w=g,x=m,A=u,g=b=0);var z=this.Ye.transform(new _geo.geotoolkit.util.Rect(v,w,v+x,w+A)),C=Math.ceil(z.aa()),D=Math.ceil(z.ba());if(0!==C&&0!==D){var E=Math.ceil(z.za()),F=Math.ceil(z.wa());n.width=E;n.height=F;E=n.getContext("2d");E.setTransform(this.Ye.Of,this.Ye.Mg,this.Ye.rf,this.Ye.tg,this.Ye.Gh,this.Ye.Ah);E.drawImage(a,b,g,m,u,v,w,x,A);a=E.getImageData(Math.floor(z.sa()),
Math.floor(z.qa()),C,D).data;E.setTransform(1,0,0,1,0,0);var z=this.Ye.transform(new d(v,w),e),F=this.Ye.transform(new d(v+x,w),c),K=this.Ye.transform(new d(v,w+A),f),H=this.Ye.transform(new d(v+x,w+A,k));v=new _geo.geotoolkit.util.Fc([z.x,F.x,H.x,K.x],[z.y,F.y,H.y,K.y]);this.gi.YI([z,F,H,K],this.Ba,this.eK,!0);if(3>this.Ba.length)this.Ba=[];else{w=[];x=[];var G=window.Infinity;A=window.Infinity;g=b=-window.Infinity;for(m=0;m<this.Ba.length;++m){u=this.Ba[m].getX();var J=this.Ba[m].getY();u<G&&(G=
u);J<A&&(A=J);u>b&&(b=u);J>g&&(g=J);w.push(u);x.push(J)}this.Ba=[];m=new _geo.geotoolkit.util.$f;m.union(h.Ne(w,x),m);u=Math.min(z.x,F.x,K.x,H.x);z=Math.min(z.y,F.y,K.y,H.y);G=Math.floor(G);A=Math.floor(A);b=Math.ceil(b);g=Math.ceil(g);var F=Math.min(100,Math.max(b-G,g-A)),I,O,M,L;n.width=F;n.height=F;K=this.Te.Ra();for(this.Te.kc(this.eK);G<b;G+=F)for(H=A;H<g;H+=F){J=E.createImageData(F,F);I=Math.min(G+F,b);L=Math.min(H+F,g);l.Ne([G,I,I,G],[H,H,L,L]);var N=m.intersect(l);if(N.length){O=window.Infinity;
I=L=-window.Infinity;M=window.Infinity;for(var T=0;T<N.length;T++)O=Math.min(O,Math.min.apply(null,N[T].Wf())),I=Math.max(I,Math.max.apply(null,N[T].Wf())),L=Math.max(L,Math.max.apply(null,N[T].Jg())),M=Math.min(M,Math.min.apply(null,N[T].Jg()));N=!1;for(O=Math.floor(O);O<Math.ceil(I);++O)for(T=Math.floor(M);T<Math.ceil(L);++T){var Q=0,P=0,S=0,U=0,R=e.bb(O,T),V=O-G,W=T-H,ca=this.gi.je(R,c),da=f.bb(_geo.geotoolkit.kd.Bb.IS(ca.getX()-u),_geo.geotoolkit.kd.Bb.IS(ca.getY()-z));if(v.contains(ca.getX(),
ca.getY())&&(ca=this.gi.J8(R,1))){for(var Z=R=0;Z<ca.getSize();++Z){var ba=ca.get(Z),X=da.x+ba.Gh,fa=da.y+ba.Ah;0>X||0>fa||X>=C||fa>=D||(X=4*(X+fa*C),Q+=a[X++]*ba.area,P+=a[X++]*ba.area,S+=a[X++]*ba.area,U+=a[X]*ba.area,R+=ba.area)}U<_geo.geotoolkit.util.Math.Jc||0===R||(N=4*(V+W*F),J.data[N++]=Q/R,J.data[N++]=P/R,J.data[N++]=S/R,J.data[N]=U/R,N=!0)}}if(p)for(I=0;I<F;I++)M=4*I,J.data[M]=0,J.data[M+1]=0,J.data[M+2]=0,J.data[M+3]=255,M=F*I*4,J.data[M]=0,J.data[M+1]=0,J.data[M+2]=0,J.data[M+3]=255,M=
4*(F*(F-1)+I),J.data[M]=0,J.data[M+1]=0,J.data[M+2]=0,J.data[M+3]=255,M=4*(F*I+F-1),J.data[M]=0,J.data[M+1]=0,J.data[M+2]=0,J.data[M+3]=255;N&&(E.clearRect(0,0,F,F),E.putImageData(J,0,0),this.Te.drawImage(n,G,H))}}p&&(this.Te.ua(new _geo.geotoolkit.attributes.Aa("blue")),this.Te.Ik(w,x,0,w.length));this.Te.kc(K)}}};b.prototype.de=function(a,b,c){this.Is();if(!this.la.trajectory)return this;var e=this.gi.transform(new d(a,b),this.Ye);b=this.gi.transform(new d(a+1,b),this.Ye);a=this.Te.Ra();b=Math.atan2(b.getY()-
e.getY(),b.getX()-e.getX());b=_geo.geotoolkit.util.Ga.dn(b,e.getX(),e.getY());this.Te.kc(b);this.Te.de(e.getX(),e.getY(),c);this.Te.kc(a);return this};b.prototype.beginPath=function(){this.Is();if(!this.la.trajectory)return this;this.twb();this.Te.beginPath();return this};b.prototype.moveTo=function(a,b){this.Is();if(!this.la.trajectory)return this;this.Yjc=a;this.Zjc=b;this.Qba=a;this.Rba=b;e.bb(a,b);e=this.gi.transform(e,this.Ye);var c=this.Te.Ra();c.Ue(e,e);this.Te.moveTo(e.getX(),e.getY());return this};
b.prototype.twb=function(){this.xJ={QD:Number.POSITIVE_INFINITY,yMin:Number.POSITIVE_INFINITY,PD:Number.NEGATIVE_INFINITY,yMax:Number.NEGATIVE_INFINITY};this.Xz={QD:Number.POSITIVE_INFINITY,yMin:Number.POSITIVE_INFINITY,PD:Number.NEGATIVE_INFINITY,yMax:Number.NEGATIVE_INFINITY};this.uda=[];this.Ura=[]};b.prototype.N7b=function(a,b){if(this.ul&&this.xJ){var c=_geo.geotoolkit.util.Ec.getBoundingBox(a);c.sa()<this.xJ.QD&&(this.xJ.QD=c.sa());c.qa()<this.xJ.yMin&&(this.xJ.yMin=c.qa());c.za()>this.xJ.PD&&
(this.xJ.PD=c.za());c.wa()>this.xJ.yMax&&(this.xJ.yMax=c.wa());c=_geo.geotoolkit.util.Ec.getBoundingBox(b);c.sa()<this.Xz.QD&&(this.Xz.QD=c.sa());c.qa()<this.Xz.yMin&&(this.Xz.yMin=c.qa());c.za()>this.Xz.PD&&(this.Xz.PD=c.za());c.wa()>this.Xz.yMax&&(this.Xz.yMax=c.wa());this.uda||(this.uda=[]);this.Ura||(this.Ura=[]);for(c=0;c<b.length;++c){var d=b[c].getX(),e=b[c].getY(),g=this.uda.length;1<g&&this.uda[g-1]===d&&this.Ura[g-1]===e||(this.uda.push(d),this.Ura.push(e))}}};b.prototype.lineTo=function(a,
b){this.Is();if(!this.la.trajectory)return this;var d=e.bb(this.Qba,this.Rba),g=c.bb(a,b);this.Ba=[];this.gi.YI([d,g],this.Ba,this.Ye,!1);for(var h=this.Te.Ra(),k=0;k<this.Ba.length;++k){var l=f.bb(this.Ba[k].getX(),this.Ba[k].getY());h.Ue(l,l);this.Te.lineTo(l.getX(),l.getY())}this.N7b([d,g],this.Ba);this.Ba=[];this.Qba=a;this.Rba=b;return this};b.prototype.arcTo=function(a,b,c,d,e){this.Is();if(!this.la.trajectory)return this;a=_geo.geotoolkit.kd.Bb.Huc(this.Qba,this.Rba,a,b,c,d,e);this.lineTo(a.line.HTc,
a.line.KTc);this.Qba=a.jq.x;this.Rba=a.jq.y;a=a.arc;this.iq(a.left,a.top,2*e,2*e,a.hn,a.dI,void 0,!0,!0);return this};b.prototype.bezierCurveTo=function(a,b,d,g,h,l,p){this.Is();if(!this.la.trajectory)return this;this.Ba=[];e.bb(this.Qba,this.Rba);c.bb(a,b);f.bb(d,g);k.bb(h,l);a=_geo.geotoolkit.util.Math.QCa(e,c,f,k);this.gi.YI(a,this.Ba,this.Ye,!1);b=this.Te.Ra();this.Te.kc(this.eK);for(d=0;d<this.Ba.length;++d)this.Te.lineTo(this.Ba[d].getX(),this.Ba[d].getY());this.Te.kc(b);this.N7b(a,this.Ba);
this.Ba=[];this.Qba=h;this.Rba=l;return this};b.prototype.stroke=function(){this.Is();if(!this.la.trajectory)return this;this.Te.stroke();return this};b.prototype.closePath=function(){this.Is();if(!this.la.trajectory)return this;void 0!==this.Yjc&&void 0!==this.Zjc&&this.lineTo(this.Yjc,this.Zjc);this.Te.closePath();return this};b.prototype.si=function(){this.Is();this.ul&&!1===this.Gd()?(this.mwb(this.uda,this.Ura,this.xJ.QD,this.xJ.yMin,this.xJ.PD,this.xJ.yMax,this.Xz.QD,this.Xz.yMin,this.Xz.PD,
this.Xz.yMax),this.twb()):this.Te.si();return this};b.prototype.wb=function(a){this.Is();if(!this.la.trajectory)return this;this.Te.wb(a);return this};b.prototype.getParent=function(){this.Is();return this.Te.getParent()};b.prototype.Lk=function(){this.Is();return this.Te.Lk()};b.prototype.rA=function(){this.Is();return this.Te?this.Te.rA():null};b.prototype.ky=function(a,b,c){this.Is();return new _geo.geotoolkit.renderer.LBb(a,b,c)};b.prototype.yab=function(a){this.Bx(a);return this};b.prototype.Bx=
function(a){this.CH=null!=a?a.clone():null;this.zy=null};b.prototype.Ew=function(a){if(null!=a){var b=this.Ra();null!=b&&(a=b.ob(a));this.Bx(a)}};b.prototype.$e=function(){return null==this.CH?new _geo.geotoolkit.util.Rect(0,this.la.trajectory.$i(),this.la.trackWidth,this.la.trajectory.Si()):this.CH instanceof _geo.geotoolkit.util.Rect?this.CH:this.CH.ga()};b.prototype.qj=function(){null==this.eq&&(this.eq=this.yr().ob(this.$e()));return this.eq};b.prototype.HFa=function(a,b,c){this.Ba=[];this.gi.YI(a,
this.Ba,this.eK,c);if(!(1>this.Ba.length)){c&&(a=this.Ba[0],b.moveTo(a.getX(),a.getY()));for(var d=1;d<this.Ba.length;++d)a=this.Ba[d],b.lineTo(a.getX(),a.getY());c&&b.close();this.Ba=[]}};b.prototype.Ni=function(a,b,g){a instanceof _geo.geotoolkit.util.$f&&(a=a.nEa());if(!this.la.clip)return this;this.Is();b=void 0!==b?b:_geo.geotoolkit.renderer.Jw.Py;null!=a&&void 0!==g&&g&&!this.Ra().pG()&&this.Ra().transform(a,a);this.yab(_geo.geotoolkit.util.Ec.q9a(this.CH,a,b));g=null;null==this.CH?(a=this.la.trajectory,
g=new _geo.geotoolkit.util.Rect(0,a.$i(),this.la.trackWidth,a.Si())):g=this.CH;a=new _geo.geotoolkit.renderer.bf;if(g instanceof _geo.geotoolkit.util.Rect)e.bb(g.sa(),g.qa()),c.bb(g.za(),g.qa()),f.bb(g.za(),g.wa()),k.bb(g.sa(),g.wa()),this.HFa([e,c,f,k],a,!0);else if(g instanceof _geo.geotoolkit.renderer.bf){b=g.uI();for(var h=g.getX(),l=g.getY(),p=new d,n=new d,x,A,z=0;z<b.length;z++){var C=g.getIndex(z);if(b[z]===_geo.geotoolkit.renderer.bf.lj.lJ)p.bb(h[C],l[C]),n.bb(h[C],l[C]),x=this.gi.transform(p,
this.eK),a.moveTo(x.getX(),x.getY());else if(b[z]===_geo.geotoolkit.renderer.bf.lj.cO)e.bb(h[C],l[C]),this.HFa([n,e],a),n.bb(h[C],l[C]);else if(b[z]===_geo.geotoolkit.renderer.bf.lj.wT)c.bb(h[C],l[C]),f.bb(h[C+1],l[C+1]),k.bb(h[C+2],l[C+2]),A=_geo.geotoolkit.util.Math.QCa(n,c,f,k),this.HFa(A,a),n.bb(h[C+2],l[C+2]);else if(b[z]===_geo.geotoolkit.renderer.bf.lj.M5){x=_geo.geotoolkit.kd.Bb.Huc(n.getX(),n.getY(),h[C],l[C],h[C+1],l[C+1],h[C+2]);A=x.line;e.bb(A.Yrd,A.Zrd);n.bb(A.HTc,A.KTc);this.HFa([e,
n],a);A=x.arc;for(var C=h[C+2],C=_geo.geotoolkit.renderer.Bb.ata(A.left+C,A.top+C,2*C,2*C,A.hn,A.dI),D,E=0;E<C.length;++E)D=C[E],e.bb(D.Yea(),D.afa()),c.bb(D.Zea(),D.bfa()),f.bb(D.$ea(),D.cfa()),k.bb(D.C9(),D.D9()),A=_geo.geotoolkit.util.Math.QCa(e,c,f,k),this.HFa(A,a);D&&n.bb(D.C9(),D.D9());x=x.jq;e.bb(x.x,x.y);this.HFa([n,e],a);n.bb(x.x,x.y)}else b[z]===_geo.geotoolkit.renderer.bf.lj.iX&&(this.HFa([n,p],a),a.close())}}D=this.Te.Ra();this.Te.kc(this.eK);this.Te.Ni(a,_geo.geotoolkit.renderer.Jw.Py,
!1);this.Te.kc(D);return this};b.prototype.Gd=function(){return this.Te?this.Te.Gd():!1};b.prototype.measureText=function(a,b){this.Is();return this.Te.measureText(a,b)};b.prototype.save=function(){this.Is();var a=null!=this.CH?this.CH.clone():null;this.XBa.push(a);this.Te.save();return this};b.prototype.restore=function(){this.Is();0<this.XBa.length&&this.yab(this.XBa.pop());this.Te.restore();return this};b.prototype.PPa=function(a){this.Is();return this.gi.zDa(a)};b.prototype.El=function(a){this.Is();
this.Te.El(a);this.L1=a;return this};b.prototype.qM=function(){this.Is();this.Te.qM();return this};b.prototype.zM=function(){this.Is();this.Te.zM();return this};b.prototype.kp=function(a){this.Is();this.Te.kp(a);return this};b.prototype.ta=function(a,b){this.Is();a?a instanceof _geo.geotoolkit.attributes.Hj&&!1===this.Gd()?(this.vMa=b,this.ul=a,this.Te.ta(null)):(this.ul=null,this.Te.ta(a,b)):(this.ul=null,this.Te.ta(a,b));return this};b.prototype.sb=function(){this.Is();return this.ul?this.ul:this.Te.sb()};
b.prototype.ua=function(a,b){this.Is();this.Te.ua(a,b);return this};b.prototype.RTb=function(a,b){for(var c=0,d=this.B5(a,b),e=0;e<d.length-1;++e)c+=_geo.geotoolkit.util.na.Cj(d[e],d[e+1]);return c};return b}();
_geo.geotoolkit.renderer.LBb=function(){function b(a,b,c){_geo.geotoolkit.renderer.canvas.Mr.call(this,a,b,c)}var a=new _geo.geotoolkit.util.Ga,g=new _geo.geotoolkit.util.na;_geo.geotoolkit.fa(b,_geo.geotoolkit.renderer.canvas.Mr);b.prototype.render=function(b,e,c,f,k,h,l,n,p){if(!(b instanceof _geo.geotoolkit.renderer.noa))throw Error("context must be instanceof geotoolkit.renderer.DeviatedRenderingContext");c=b.gi.transform(g.bb(e+this.aa()/2,c+this.ba()/2),a);e=c.getX()-this.aa()/2;c=c.getY()-
this.ba()/2;return f||k?_geo.geotoolkit.renderer.canvas.Mr.prototype.render.call(this,b.gDc(),e,c,f,k,h,l,n,p):_geo.geotoolkit.renderer.canvas.Mr.prototype.render.call(this,b.gDc(),e,c)};return b}();
_geo.geotoolkit.kd.ia.dJa=function(){function b(a){_geo.geotoolkit.controls.ia.fc.call(this,a);this.gi=this.v7=null;this.cd=this.Qb instanceof _geo.geotoolkit.scene.og?this.Qb.getParent():this.Qb}_geo.geotoolkit.fa(b,_geo.geotoolkit.controls.ia.fc);_geo.geotoolkit.da(b,"geotoolkit.deviation.tools.DeviationTool");b.prototype.Umd=function(){var a=this.v7.IM(),b=this.v7.Ya();this.gi=a.transformer.create(a,b)};b.prototype.hQa=function(){if(null==this.v7){var a=_geo.geotoolkit.selection.from(this.Qb.getRoot()).He(function(a){return a instanceof
_geo.geotoolkit.scene.bha}).B_();null!=a&&0<a.length&&(this.v7=a[0],this.v7.addListener(_geo.geotoolkit.scene.bha.$.MBb,function(){this.Umd()}.bind(this)))}return this.v7};return b}();
_geo.geotoolkit.kd.ia.fdc=function(){function b(){_geo.geotoolkit.scene.Group.call(this);this.kk(!1);this.xu=new _geo.geotoolkit.scene.shapes.Line;this.va(this.xu);this.Ce=(new _geo.geotoolkit.scene.shapes.Text({textstyle:new _geo.geotoolkit.attributes.eb})).TI(!0);this.va(this.Ce);this.rpa=0;this.du(_geo.geotoolkit.kd.Bk.lb);this.Hoc=null}_geo.geotoolkit.fa(b,_geo.geotoolkit.scene.Group);b.prototype.ma=function(a,b){this.ib()&&(null==a?(this.Ce&&this.Ri(this.Ce.ga(),b),this.xu&&this.Ri(this.xu.ga(),
b)):this.Ri(a,b));return this};b.prototype.setData=function(a,b,d){this.Hoc=d;this.xu.Dw({from:a,to:b});var e=Math.atan2(b.getY()-a.getY(),b.getX()-a.getX());a=this.Mkb===_geo.geotoolkit.kd.Bk.lb?new _geo.geotoolkit.util.na((a.getX()+b.getX())/2,(a.getY()+b.getY())/2):this.Mkb===_geo.geotoolkit.kd.Bk.wd?new _geo.geotoolkit.util.na(a.getX(),a.getY()):new _geo.geotoolkit.util.na(b.getX(),b.getY());d=null!=this.Ce.Gza?this.Ce.Gza(d.getX(),d.getY()):d.toString();this.Ce.jc(d);0!==this.rpa&&this.Ce.rotate(-this.rpa,
this.Ce.uA(),this.Ce.ny());this.Ce.yc(a);this.rpa=e;0!==this.rpa&&this.Ce.rotate(this.rpa,this.Ce.uA(),this.Ce.ny());return this};b.prototype.getData=function(){return this.Hoc};b.prototype.Rs=function(a){a&&(a.line&&this.Yod(a.line),a.label&&this.Ov(a.label));return this};b.prototype.Yod=function(a){void 0!==a.linestyle&&this.xu.ua(a.linestyle);null!=a.visible&&this.xu.Ka(a.visible)};b.prototype.du=function(a){this.Mkb=a;this.Mkb===_geo.geotoolkit.kd.Bk.lb?this.Ce.Cd(_geo.geotoolkit.util.Da.Ei):
this.Mkb===_geo.geotoolkit.kd.Bk.wd?this.Ce.Cd(_geo.geotoolkit.util.Da.Ij):this.Ce.Cd(_geo.geotoolkit.util.Da.cl)};b.prototype.Ov=function(a){void 0!==a.textstyle&&this.Ce.wb(a.textstyle);null!=a.visible&&this.Ce.Ka(a.visible);void 0!==a.textconverter&&(this.Ce.Gza=a.textconverter);null!=a.position&&this.du(a.position)};return b}();
_geo.geotoolkit.kd.ia.qfb=function(){function b(a,b){_geo.geotoolkit.controls.ia.ev.call(this,a);this.vg=b}_geo.geotoolkit.fa(b,_geo.geotoolkit.controls.ia.ev);b.prototype.getPosition=function(){return this.vg};return b}();
_geo.geotoolkit.kd.ia.rfb=function(){function b(a,b){_geo.geotoolkit.kd.ia.dJa.call(this,{slots:{pointermove:this.Wd.bind(this)},name:"string"===typeof b&&""!==b?b:"MD-cursor",layer:a instanceof _geo.geotoolkit.scene.Group||a instanceof _geo.geotoolkit.scene.og?a:null});this.jza=new _geo.geotoolkit.kd.ia.fdc;this.Rs({line:{linestyle:(new _geo.geotoolkit.attributes.Aa("black",1,[3,2])).Yd({x:!0,y:!0})}});this.Qb.va(this.jza);this.jra=null}var a=new _geo.geotoolkit.util.na,g=new _geo.geotoolkit.util.Ga;
_geo.geotoolkit.fa(b,_geo.geotoolkit.kd.ia.dJa);_geo.geotoolkit.da(b,"geotoolkit.deviation.tools.MDCursorTool");b.$={dQ:"onPositionChanged"};b.prototype.uj=function(){var a=this.isEnabled();this.jza.Ka(a);this.Qb.ma();_geo.geotoolkit.kd.ia.dJa.prototype.uj.call(this)};b.prototype.Rs=function(a){null!=a.enabled&&this.cc(a.enabled);this.jza.Rs(a);return this};b.prototype.Oyd=function(a){this.setActive(!1)};b.prototype.Wd=function(d){if(this.isEnabled()){var e=this.hQa();if(e){var c=e.IM();null!=c&&
(e=e.Ya(),this.gi?this.gi.update(e):this.gi=c.transformer.create(c,e),c=this.UK(d),a.bb(c.x,c.y),c=this.gi.je(a),(0,window.isNaN)(c.getX())||(0,window.isNaN)(c.getY())?(this.jza.Ka(!1),null!==this.jra&&(this.jra=null,this.fireEvent(b.$.dQ,new _geo.geotoolkit.kd.ia.qfb(d,this.jra)))):(this.ISc(c),this.jza.Ka(!0),this.setActive(!0),null!=this.jra&&_geo.geotoolkit.util.Math.equals(this.jra.getY(),c.getY())&&_geo.geotoolkit.util.Math.equals(this.jra.getX(),c.getX())||(this.jra=c,this.fireEvent(b.$.dQ,
new _geo.geotoolkit.kd.ia.qfb(d,this.jra)))))}}};b.prototype.update=function(){if(this.isEnabled()){var a=this.jza.getData(),b=this.hQa();null!=a&&null!=b&&(this.gi.update(b.Ya()),this.ISc(a))}};b.prototype.ISc=function(b){var e=this.hQa().IM();if(e){a.bb(0,b.getY());var c=this.gi.transform(a,g),e=e.trackWidth;a.bb(e,b.getY());var e=this.gi.transform(a,g),f=this.cd.Ya();null!=f&&(c=f.Ue(c),e=f.Ue(e));this.jza.setData(c,e,b)}};return b}();
_geo.geotoolkit.kd.ia.Foa=function(b,a){_geo.geotoolkit.controls.ia.ev.call(this,b);a=_geo.geotoolkit.Ca(a,{},!0);void 0!==a.area&&(this.wh=a.area);void 0!==a.startmd&&(this.B6c=a.startmd);void 0!==a.endmd&&(this.I3c=a.endmd)};_geo.geotoolkit.fa(_geo.geotoolkit.kd.ia.Foa,_geo.geotoolkit.controls.ia.ev);_geo.geotoolkit.da(_geo.geotoolkit.kd.ia.Foa,"geotoolkit.deviation.tools.MDRubberBandEventArgs");_geo.geotoolkit.kd.ia.Foa.prototype.AEc=function(){return this.B6c};
_geo.geotoolkit.kd.ia.Foa.prototype.Pzc=function(){return this.I3c};_geo.geotoolkit.kd.ia.Foa.prototype.getArea=function(){return this.wh};
_geo.geotoolkit.kd.ia.YXa=function(){function b(b,c){c=c||_geo.geotoolkit.kd.ia.YXa.$D.edc;var g;g="md"===c?{pointerdown:this.Kkd.bind(this),pointermove:this.Mkd.bind(this),pointerup:this.Okd.bind(this)}:{pointerdown:this.Lkd.bind(this),pointermove:this.Nkd.bind(this),pointerup:this.Pkd.bind(this)};_geo.geotoolkit.kd.ia.dJa.call(this,{slots:g,layer:b,name:"MD-rubberband"});this.cc(!1);this.X1=!0;this.Xca=(new _geo.geotoolkit.scene.shapes.Fc).Ka(!1).ua((new _geo.geotoolkit.attributes.Aa(d,1,[2,3])).Yd({x:!1,
y:!1})).ta(new _geo.geotoolkit.attributes.Fa(e));null!=this.Qb&&this.Qb.va(this.Xca);this.O2a=(new _geo.geotoolkit.scene.shapes.lc(new _geo.geotoolkit.util.Rect(0,0,0,0))).Ka(!1).ua((new _geo.geotoolkit.attributes.Aa("red",2)).Yd({x:!0,y:!0})).ta(null);null!=this.Qb&&this.Qb.va(this.O2a);this.SJ=null;this.hx=window.NaN;this.ud=0;this.KU=this.DR=window.NaN;this.Vnb=new a;this.Unb=new a;this.o2a=new _geo.geotoolkit.util.Rect}var a=_geo.geotoolkit.util.na,g=_geo.geotoolkit.kd.ia.Foa,d="#bdbdbd",e="rgba(189,189,189,0.5)",
c=new a,f=new _geo.geotoolkit.util.Ga,k=_geo.geotoolkit.controls.ia.yq;_geo.geotoolkit.fa(b,_geo.geotoolkit.kd.ia.dJa);_geo.geotoolkit.da(b,"geotoolkit.deviation.tools.MDRubberBand");b.$D={edc:"md",gza:"xy"};b.prototype.prd=function(){var a=this.hQa();if(!a)return null;var b=a.IM(),c=a.Ya();this.gi?this.gi.update(c):this.gi=b.transformer.create(b,c);this.hx=b.trackWidth;this.ud=b.offset;return a};b.prototype.dPb=function(a){var b=this.hQa();if(!b)return c.bb(window.NaN,window.NaN);var d=b.IM(),b=
b.Ya();this.gi?this.gi.update(b):this.gi=d.transformer.create(d,b);this.hx=d.trackWidth;this.ud=d.offset;a=this.UK(a);c.bb(a.x,a.y);return this.gi.je(c)};b.prototype.Kkd=function(a){var b=this.dPb(a);(0,window.isNaN)(b.getX())||(0,window.isNaN)(b.getY())||(a.stopPropagation(!0),this.setActive(!0),this.DR=b.getY(),this.fireEvent(k.$.aF,new g(a,{startMD:this.DR})))};b.prototype.Okd=function(a){if(this.wf()){var b=this.dPb(a);(0,window.isNaN)(b.getX())||(0,window.isNaN)(b.getY())?this.wf()&&(this.setActive(!1),
this.Xca.Ka(!1).ma()):(a.stopPropagation(!0),this.setActive(!1),this.Xca.Ka(!1).ma(),this.fireEvent(k.$.mma,new g(a,{startMD:this.DR,endMD:this.KU})),b=new _geo.geotoolkit.util.Rect(this.LNa.getX(),this.LNa.getY(),this.MNa.getX(),this.MNa.getY()),this.fireEvent(k.$.au,new g(a,{area:b})),this.X1&&this.cc(!1))}};b.prototype.hNc=function(){var b=this.cd.Ya(),d=null;b&&(d=b.Vd());var e=[new a(0,this.DR),new a(this.hx,this.DR),new a(this.hx,this.KU),new a(0,this.KU)],b=[];this.gi.YI(e,b,f,!0);c.bb(this.hx/
2-this.ud,this.DR);this.LNa=this.gi.transform(c,f);c.bb(this.hx/2-this.ud,this.KU);this.MNa=this.gi.transform(c,f);if(d)for(d.cb(this.LNa,this.LNa),d.cb(this.MNa,this.MNa),e=0;e<b.length;++e)d.cb(b[e],b[e]);var g=[],k=[];b.forEach(function(a){g.push(a.getX());k.push(a.getY())});this.Xca.Ne(g,k)};b.prototype.Mkd=function(a){if(this.wf()){var b=this.dPb(a);(0,window.isNaN)(b.getX())||(0,window.isNaN)(b.getY())||(a.stopPropagation(!0),this.KU=b.getY(),this.hNc(),this.Xca.Ka(!0).ma(),this.fireEvent(k.$.mma,
new g(a,{startMD:this.DR,endMD:this.KU})))}};b.prototype.Lkd=function(a){this.lrc=this.Qe(this.Qb,a);var b=this.UK(a);this.Vnb.bb(Math.round(b.x),Math.round(b.y));a.stopPropagation(!0);this.setActive(!0);this.prd()};b.prototype.Pkd=function(a){if(this.wf()&&(a.stopPropagation(!0),this.setActive(!1),this.Xca.Ka(!1).ma(),this.O2a.Ka(!1).ma(),!(0,window.isNaN)(this.KU)&&!(0,window.isNaN)(this.DR))){this.fireEvent(k.$.mma,new g(a,{startMD:this.DR,endMD:this.KU}));var b=new _geo.geotoolkit.util.Rect(this.LNa.getX(),
this.LNa.getY(),this.MNa.getX(),this.MNa.getY());this.fireEvent(k.$.au,new g(a,{area:b}));this.X1&&this.cc(!1)}};b.prototype.qva=function(a,b){c.bb(a,b);var d=this.gi.je(c).getY();(0,window.isNaN)(d)||(d<this.DR&&(this.DR=d),d>this.KU&&(this.KU=d))};b.prototype.s9c=function(){var a=this.hQa();if(a){this.DR=Number.POSITIVE_INFINITY;this.KU=Number.NEGATIVE_INFINITY;for(var b=this.o2a.qa(),a=this.o2a.wa(),c=this.o2a.sa(),d=this.o2a.za(),e=c;e<d;e+=10)this.qva(e,b),this.qva(e,a);this.qva(d,b);for(this.qva(d,
a);b<a;b+=10)this.qva(c,b),this.qva(d,b);this.qva(c,a);this.qva(d,a)}else this.KU=this.DR=window.NaN};b.prototype.Nkd=function(a){if(this.wf()){var b=this.UK(a);this.Unb.bb(Math.round(b.x),Math.round(b.y));if(this.Unb.x!==this.Vnb.x&&this.Unb.y!==this.Vnb.y){b=function(a,b,c){a.zb(Math.min(b.x,c.x),Math.min(b.y,c.y),Math.max(b.x,c.x),Math.max(b.y,c.y))};b(this.o2a,this.Vnb,this.Unb);var c=this.Qe(this.Qb,a);!1===this.O2a.ib()&&this.lrc.AM(c)||(this.v7c=c,b(this.O2a,this.lrc,this.v7c),this.O2a.Ka(!0).ma(),
this.s9c(),(0,window.isNaN)(this.KU)||(0,window.isNaN)(this.DR)?this.Xca.Ka(!1).ma():(this.hNc(),this.Xca.Ka(!0).ma()),a.stopPropagation(!0),this.fireEvent(k.$.mma,new g(a,{startMD:this.DR,endMD:this.KU})))}}};b.prototype.setOptions=function(a){null!=a.enabled&&this.cc(a.enabled);void 0!==a.linestyle&&this.Xca.ua(a.linestyle);void 0!==a.fillstyle&&this.Xca.ta(a.fillstyle);null!=a.autodisabled&&(this.X1=a.autodisabled);return this};return b}();
(function(){var b="geotoolkit",a="Transformation",g="scene",d="Events",e="renderer",c="tools",f=_geo.geotoolkit.wr,k=_geo.geotoolkit.$r,h=null,l=null;f(b+".deviation.LabelPosition",_geo.geotoolkit.kd.Bk);f(b+".deviation.LabelPosition.Left",(l=_geo.geotoolkit.kd.Bk).wd);f(b+".deviation.LabelPosition.Center",l.lb);f(b+".deviation.LabelPosition.Right",l.$c);f(b+".deviation.Deviated"+a+"",(l=_geo.geotoolkit.kd).cJa);k(h=_geo.geotoolkit.kd.cJa.prototype,"update",h.update,{update:0});k(h,"transform",h.transform,
{transform:0});k(h,"inverseTransform",h.je,{je:0});k(h,"transformLine",h.B5,{B5:0});k(h,"transformLines",h.YI,{YI:0});k(h,"findBounds",h.zDa,{zDa:0});k(h,"contains",h.contains,{contains:0});k(h,"scaleXAt",h.Tfa,{Tfa:0});k(h,"scaleYAt",h.Vfa,{Vfa:0});k(h,"bitmapScaleY",h.Vsc,{Vsc:0});k(h,"getScalesInfo",h.KWb,{KWb:0});f(b+".deviation.Transformer2d",l.bLa);k(h=_geo.geotoolkit.kd.bLa.prototype,"create",h.create,{create:0});k(h=_geo.geotoolkit.kd.Vhc.prototype,"update",h.update,{update:0});k(h,"transform",
h.transform,{transform:0});k(h,"inverseTransform",h.je,{je:0});k(h,"transformLine",h.B5,{B5:0});k(h,"transformLines",h.YI,{YI:0});k(h,"findBounds",h.zDa,{zDa:0});k(h,"contains",h.contains,{contains:0});k(h,"scaleXAt",h.Tfa,{Tfa:0});k(h,"scaleYAt",h.Vfa,{Vfa:0});k(h,"maxScaleX",h.o_,{o_:0});k(h,"maxScaleY",h.p_,{p_:0});k(h,"minScaleX",h.lW,{lW:0});k(h,"minScaleY",h.mW,{mW:0});k(h,"digitize",h.J8,{J8:0});f(b+".deviation.TVDTransformer",l.Whc);k(h=_geo.geotoolkit.kd.Whc.prototype,"getOptions",h.jb,{jb:0});
k(h,"setOptions",h.setOptions,{setOptions:0});k(h,"create",h.create,{create:0});f(b+".deviation.PiecewiseTransformer",l.zEb);k(h=_geo.geotoolkit.kd.zEb.prototype,"getOptions",h.jb,{jb:0});k(h,"setOptions",h.setOptions,{setOptions:0});k(h,"create",h.create,{create:0});f(b+".deviation.Trajectory2d",l.rhb);k(h=_geo.geotoolkit.kd.rhb.prototype,"getX",h.getX,{getX:0});k(h,"getY",h.getY,{getY:0});k(h,"getDepth",h.wc,{wc:0});k(h,"count",h.count,{count:0});k(h,"minDepth",h.$i,{$i:0});k(h,"maxDepth",h.Si,
{Si:0});f(b+".deviation.Trajectory2d.createTrajectory",_geo.geotoolkit.kd.rhb.Fad);k(h,"getMinX",h.KV,{KV:0});k(h,"getMinY",h.LV,{LV:0});k(h,"getMaxX",h.OZ,{OZ:0});k(h,"getMaxY",h.PZ,{PZ:0});f(b+"."+g+".DeviatedCompositeNode",_geo.geotoolkit.scene.bha);f(b+"."+g+".DeviatedCompositeNode."+d+"",_geo.geotoolkit.scene.bha.$);f(b+"."+g+".DeviatedCompositeNode."+d+".DeviationChanged",_geo.geotoolkit.scene.bha.$.MBb);k(h=_geo.geotoolkit.scene.bha.prototype,"addListener",h.addListener,{addListener:0});k(h,
"removeListener",h.removeListener,{removeListener:0});k(h,"onDeviationChanged",h.i_b,{i_b:0});k(h,"setDeviation",h.H_,{H_:0});k(h,"getDeviation",h.IM,{IM:0});k(h,"getModelLimits",h.xa,{xa:0});k(h,"getBounds",h.ga,{ga:0});k(h,"setBounds",h.Ea,{Ea:0});k(h,"getTrajectoryLimits",h.Itb,{Itb:0});k(h,"updateState",h.Pa,{Pa:0});k(h,"getContentsTransform",h.ee,{ee:0});k(h,"invalidateParent",h.Ri,{Ri:0});k(h,"checkCollision",h.ie,{ie:0});k(h,"render",h.render,{render:0});k(h,"findDepthRange",h.kxc,{kxc:0});
k(h=_geo.geotoolkit.renderer.noa.prototype,"setDeviation",h.H_,{H_:0});k(h,"getInfo",h.Urb,{Urb:0});k(h,"update",h.update,{update:0});k(h,"updateTransformation",h.Kzb,{Kzb:0});k(h,"pushTransformation",h.qc,{qc:0});k(h,"getTransformation",h.Ra,{Ra:0});k(h,"setTransformation",h.kc,{kc:0});k(h,"getInverseTransformation",h.yr,{yr:0});k(h,"getLocalTransformation",h.mz,{mz:0});k(h,"drawRectangle",h.zc,{zc:0});k(h,"drawPolygon",h.Ik,{Ik:0});k(h,"drawPolyline",h.xn,{xn:0});k(h,"drawLine",h.Pd,{Pd:0});k(h,
"drawEllipse",h.po,{po:0});k(h,"drawArc",h.iq,{iq:0});k(h,"drawAnnulusArc",h.jx,{jx:0});k(h,"drawImage",h.drawImage,{drawImage:0});k(h,"drawText",h.de,{de:0});k(h,"beginPath",h.beginPath,{beginPath:0});k(h,"moveTo",h.moveTo,{moveTo:0});k(h,"lineTo",h.lineTo,{lineTo:0});k(h,"arcTo",h.arcTo,{arcTo:0});k(h,"bezierCurveTo",h.bezierCurveTo,{bezierCurveTo:0});k(h,"stroke",h.stroke,{stroke:0});k(h,"closePath",h.closePath,{closePath:0});k(h,"fillPath",h.si,{si:0});k(h,"setTextStyle",h.wb,{wb:0});k(h,"getParent",
h.getParent,{getParent:0});k(h,"getContext2d",h.Lk,{Lk:0});k(h,"createRenderingState",h.rA,{rA:0});k(h,"createSurface",h.ky,{ky:0});k(h,"setDeviceRect",h.Bx,{Bx:0});k(h,"setModelRect",h.Ew,{Ew:0});k(h,"getDeviceRect",h.$e,{$e:0});k(h,"getModelRect",h.qj,{qj:0});k(h,"setClip",h.Ni,{Ni:0});k(h,"isPicking",h.Gd,{Gd:0});k(h,"measureText",h.measureText,{measureText:0});k(h,"save",h.save,{save:0});k(h,"restore",h.restore,{restore:0});k(h,"findLinearBbox",h.PPa,{PPa:0});k(h,"setCurrentNode",h.El,{El:0});
k(h,"beginRendering",h.qM,{qM:0});k(h,"endRendering",h.zM,{zM:0});k(h,"setFillPattern",h.kp,{kp:0});k(h,"setFillStyle",h.ta,{ta:0});k(h,"getFillStyle",h.sb,{sb:0});k(h,"setLineStyle",h.ua,{ua:0});f(b+"."+e+".DeviatedSurface",_geo.geotoolkit.renderer.LBb);k(h=_geo.geotoolkit.renderer.LBb.prototype,"render",h.render,{render:0});f(b+".deviation."+c+".DeviationTool",(l=_geo.geotoolkit.kd.ia).dJa);k(h=_geo.geotoolkit.kd.ia.fdc.prototype,"invalidate",h.ma,{ma:0});f(b+".deviation."+c+".MDCursorEventArgs",
l.qfb);k(h=_geo.geotoolkit.kd.ia.qfb.prototype,"getPosition",h.getPosition,{getPosition:0});f(b+".deviation."+c+".MDCursorTool",l.rfb);f(b+".deviation."+c+".MDCursorTool."+d+"",_geo.geotoolkit.kd.ia.rfb.$);f(b+".deviation."+c+".MDCursorTool."+d+".onPositionChanged",_geo.geotoolkit.kd.ia.rfb.$.dQ);k(h=_geo.geotoolkit.kd.ia.rfb.prototype,"onActiveStateChanged",h.uj,{uj:0});k(h,"setSettings",h.Rs,{Rs:0});k(h,"update",h.update,{update:0});f(b+".deviation."+c+".MDRubberBandEventArgs",(l=_geo.geotoolkit.kd.ia).Foa);
k(h=_geo.geotoolkit.kd.ia.Foa.prototype,"getStartMD",h.AEc,{AEc:0});k(h,"getEndMD",h.Pzc,{Pzc:0});k(h,"getArea",h.getArea,{getArea:0});f(b+".deviation."+c+".MDRubberBand",l.YXa);f(b+".deviation."+c+".MDRubberBand.Mode",_geo.geotoolkit.kd.ia.YXa.$D);f(b+".deviation."+c+".MDRubberBand.Mode.MD",(l=_geo.geotoolkit.kd.ia.YXa.$D).edc);f(b+".deviation."+c+".MDRubberBand.Mode.XY",l.gza);k(h=_geo.geotoolkit.kd.ia.YXa.prototype,"setOptions",h.setOptions,{setOptions:0})})();

    return _geo;
}));
/* eslint-enable */
/* tslint:enable */